<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: kernel/usb/xhci/xhci.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_dc43877d82dd332f9fb2071fcca799d6.html">kernel</a></li><li class="navelem"><a class="el" href="dir_d61e9a928b92a50ee109474a1a5f7245.html">usb</a></li><li class="navelem"><a class="el" href="dir_0beda57796f8da84b9c6028d6d78c965.html">xhci</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">xhci.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="xhci_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="xhci_8hpp.html">usb/xhci/xhci.hpp</a>&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160; </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;cstring&gt;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="logger_8hpp.html">logger.hpp</a>&quot;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="pci_8hpp.html">pci.hpp</a>&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="interrupt_8hpp.html">interrupt.hpp</a>&quot;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="setupdata_8hpp.html">usb/setupdata.hpp</a>&quot;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="device_8hpp.html">usb/device.hpp</a>&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="descriptor_8hpp.html">usb/descriptor.hpp</a>&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="speed_8hpp.html">usb/xhci/speed.hpp</a>&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; </div>
<div class="line"><a name="l00012"></a><span class="lineno"><a class="line" href="namespaceanonymous__namespace_02xhci_8cpp_03.html">   12</a></span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  <span class="keyword">using namespace </span><a class="code" href="namespaceusb_1_1xhci.html">usb::xhci</a>;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno"><a class="line" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a4133327bd6ec5fac64f5e44a96751671">   15</a></span>&#160;  <a class="code" href="classError.html">Error</a> <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a4133327bd6ec5fac64f5e44a96751671">RegisterCommandRing</a>(<a class="code" href="classusb_1_1xhci_1_1Ring.html">Ring</a>* ring, <a class="code" href="classMemMapRegister.html">MemMapRegister&lt;CRCR_Bitmap&gt;</a>* crcr) {</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <a class="code" href="unionusb_1_1xhci_1_1CRCR__Bitmap.html">CRCR_Bitmap</a> <a class="code" href="setupdata_8hpp.html#ae7f66047e6e39ba2bb6af8b95f00d1dd">value</a> = crcr-&gt;<a class="code" href="classMemMapRegister.html#a7d0631093e47440e0b414383dde241ea">Read</a>();</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <a class="code" href="setupdata_8hpp.html#ae7f66047e6e39ba2bb6af8b95f00d1dd">value</a>.bits.ring_cycle_state = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <a class="code" href="setupdata_8hpp.html#ae7f66047e6e39ba2bb6af8b95f00d1dd">value</a>.bits.command_stop = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <a class="code" href="setupdata_8hpp.html#ae7f66047e6e39ba2bb6af8b95f00d1dd">value</a>.bits.command_abort = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <a class="code" href="setupdata_8hpp.html#ae7f66047e6e39ba2bb6af8b95f00d1dd">value</a>.SetPointer(<span class="keyword">reinterpret_cast&lt;</span>uint64_t<span class="keyword">&gt;</span>(ring-&gt;<a class="code" href="classusb_1_1xhci_1_1Ring.html#abee6a4476eb252eb67982fbdcac81d34">Buffer</a>()));</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    crcr-&gt;<a class="code" href="classMemMapRegister.html#a4bd4e2326664194cc74cea3996ad4a13">Write</a>(<a class="code" href="setupdata_8hpp.html#ae7f66047e6e39ba2bb6af8b95f00d1dd">value</a>);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="error_8hpp.html#a073d632b05d5b46e6f1690a7c9e0db6a">MAKE_ERROR</a>(<a class="code" href="classError.html#ab5980e13b879db253df802b0950d1708a31ec89da55e8cd350110774ee7004f1a">Error::kSuccess</a>);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  }</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a625d5cf01f252cb2975c2a55fdd5e1b8">   25</a></span>&#160;  <span class="keyword">enum class</span> <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a625d5cf01f252cb2975c2a55fdd5e1b8">ConfigPhase</a> {</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a625d5cf01f252cb2975c2a55fdd5e1b8a32a54fa8629fe6e9cb3e265e959258d8">kNotConnected</a>,</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a625d5cf01f252cb2975c2a55fdd5e1b8a6e94fe5189de18c3b459fa3fe4329523">kWaitingAddressed</a>,</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a625d5cf01f252cb2975c2a55fdd5e1b8a5e20f5dfc0be057afa18fdadac6d2f7a">kResettingPort</a>,</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a625d5cf01f252cb2975c2a55fdd5e1b8a12fcf69fd111b569f3e300dce1fbcb4c">kEnablingSlot</a>,</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a625d5cf01f252cb2975c2a55fdd5e1b8ad9f3f8d48edae6e6b9087fef4d15d136">kAddressingDevice</a>,</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a625d5cf01f252cb2975c2a55fdd5e1b8ac855d30d1700a38672c1e2279c15eedf">kInitializingDevice</a>,</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a625d5cf01f252cb2975c2a55fdd5e1b8ab666c147ab3da9f993c6d438a303ca5a">kConfiguringEndpoints</a>,</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a625d5cf01f252cb2975c2a55fdd5e1b8a7ebe83f8599de272f076e1cbcb0cbb4d">kConfigured</a>,</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  };</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="comment">/* root hub port はリセット処理をしてからアドレスを割り当てるまでは</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">   * 他の処理を挟まず，そのポートについての処理だけをしなければならない．</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">   * kWaitingAddressed はリセット（kResettingPort）からアドレス割り当て</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">   * （kAddressingDevice）までの一連の処理の実行を待っている状態．</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#aaf7fd6ae7c6a392b0a16a84473c10872">   41</a></span>&#160;  std::array&lt;volatile ConfigPhase, 256&gt; <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#aaf7fd6ae7c6a392b0a16a84473c10872">port_config_phase</a>{};  <span class="comment">// index: port number</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#aa9c4ec63a5252e2696c922e267b068e6">   46</a></span>&#160;  uint8_t <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#aa9c4ec63a5252e2696c922e267b068e6">addressing_port</a>{0};</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a9c32d83b4bffdb9c24178d5033fbfb21">   48</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a9c32d83b4bffdb9c24178d5033fbfb21">InitializeSlotContext</a>(<a class="code" href="unionusb_1_1xhci_1_1SlotContext.html">SlotContext</a>&amp; ctx, <a class="code" href="classusb_1_1xhci_1_1Port.html">Port</a>&amp; port) {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    ctx.bits.<a class="code" href="unionusb_1_1xhci_1_1SlotContext.html#af0879c8e856fd13454a726a6f8f0e744">route_string</a> = 0;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    ctx.bits.<a class="code" href="unionusb_1_1xhci_1_1SlotContext.html#a9418d01500c3f8e2edd1ddec34e824f3">root_hub_port_num</a> = port.<a class="code" href="classusb_1_1xhci_1_1Port.html#a4564877db0b7ab0b5cf25e94ee406ae5">Number</a>();</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    ctx.bits.<a class="code" href="unionusb_1_1xhci_1_1SlotContext.html#a15b0e0fd6dd66c92efca19bd9682989d">context_entries</a> = 1;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    ctx.bits.<a class="code" href="unionusb_1_1xhci_1_1SlotContext.html#ac83f0bc66a8418d8dd54a09a07ec2602">speed</a> = port.<a class="code" href="classusb_1_1xhci_1_1Port.html#ac8a04170075fd99ee806fc573598bb75">Speed</a>();</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  }</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a31f446bc33b51dfa4a2fda7caf6f410f">   55</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a31f446bc33b51dfa4a2fda7caf6f410f">DetermineMaxPacketSizeForControlPipe</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> slot_speed) {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">switch</span> (slot_speed) {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">case</span> 4: <span class="comment">// Super Speed</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="keywordflow">return</span> 512;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordflow">case</span> 3: <span class="comment">// High Speed</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="keywordflow">return</span> 64;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="keywordflow">return</span> 8;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    }</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#ac8a768fa737e790c084fce025ce4695f">   66</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#ac8a768fa737e790c084fce025ce4695f">MostSignificantBit</a>(uint32_t <a class="code" href="setupdata_8hpp.html#ae7f66047e6e39ba2bb6af8b95f00d1dd">value</a>) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="setupdata_8hpp.html#ae7f66047e6e39ba2bb6af8b95f00d1dd">value</a> == 0) {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordtype">int</span> msb_index;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    __asm__(<span class="stringliteral">&quot;bsr %1, %0&quot;</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        : <span class="stringliteral">&quot;=r&quot;</span>(msb_index) : <span class="stringliteral">&quot;m&quot;</span>(<a class="code" href="setupdata_8hpp.html#ae7f66047e6e39ba2bb6af8b95f00d1dd">value</a>));</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordflow">return</span> msb_index;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#acf4166de45ff46cf84d073a1720edc2b">   77</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#acf4166de45ff46cf84d073a1720edc2b">InitializeEP0Context</a>(<a class="code" href="unionusb_1_1xhci_1_1EndpointContext.html">EndpointContext</a>&amp; ctx,</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                            <a class="code" href="classusb_1_1xhci_1_1Ring.html">Ring</a>* transfer_ring,</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="descriptor_8hpp.html#adf8eaadf8ab47b2ff12d0dcfb448dbe8">max_packet_size</a>) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    ctx.bits.<a class="code" href="unionusb_1_1xhci_1_1EndpointContext.html#aadcdbbcda4fef3b4402e41039d8f017b">ep_type</a> = 4; <span class="comment">// Control Endpoint. Bidirectional.</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    ctx.bits.<a class="code" href="unionusb_1_1xhci_1_1EndpointContext.html#a8488487cf5b8435fbdc20a6b9c460255">max_packet_size</a> = <a class="code" href="descriptor_8hpp.html#adf8eaadf8ab47b2ff12d0dcfb448dbe8">max_packet_size</a>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    ctx.bits.<a class="code" href="unionusb_1_1xhci_1_1EndpointContext.html#ac10a133508079d215eae877560e962c7">max_burst_size</a> = 0;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    ctx.<a class="code" href="unionusb_1_1xhci_1_1EndpointContext.html#aa76e278ee9809f6454cf3583945c0c17">SetTransferRingBuffer</a>(transfer_ring-&gt;<a class="code" href="classusb_1_1xhci_1_1Ring.html#abee6a4476eb252eb67982fbdcac81d34">Buffer</a>());</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    ctx.bits.<a class="code" href="unionusb_1_1xhci_1_1EndpointContext.html#a4db46d3a32b7479b15d30509ff36a00d">dequeue_cycle_state</a> = 1;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    ctx.bits.<a class="code" href="unionusb_1_1xhci_1_1EndpointContext.html#a16cc0f2efd47a463b4cad7bed1d15667">interval</a> = 0;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    ctx.bits.<a class="code" href="unionusb_1_1xhci_1_1EndpointContext.html#a662896f1b679a377c2eb7c5ab656738f">max_primary_streams</a> = 0;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    ctx.bits.<a class="code" href="unionusb_1_1xhci_1_1EndpointContext.html#aab5593e170f06ca53639abcf760b4f8e">mult</a> = 0;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    ctx.bits.<a class="code" href="unionusb_1_1xhci_1_1EndpointContext.html#a86ba855dbcef90123c70191c827ab985">error_count</a> = 3;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a496b34569d293b42029c189d10f6c3fc">   91</a></span>&#160;  <a class="code" href="classError.html">Error</a> <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a496b34569d293b42029c189d10f6c3fc">ResetPort</a>(<a class="code" href="classusb_1_1xhci_1_1Controller.html">Controller</a>&amp; xhc, <a class="code" href="classusb_1_1xhci_1_1Port.html">Port</a>&amp; port) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> is_connected = port.<a class="code" href="classusb_1_1xhci_1_1Port.html#a827cc119289d1d9de12a1cb5e5ceb711">IsConnected</a>();</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="logger_8cpp.html#a7b67f04545cc3bc4793c750046527b99">Log</a>(<a class="code" href="logger_8hpp.html#aca1fd1d8935433e6ba2e3918214e07f9a5f66aaa2354d753bfaad7a8887e39216">kDebug</a>, <span class="stringliteral">&quot;ResetPort: port.IsConnected() = %s\n&quot;</span>,</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        is_connected ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span>);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">if</span> (!is_connected) {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="error_8hpp.html#a073d632b05d5b46e6f1690a7c9e0db6a">MAKE_ERROR</a>(<a class="code" href="classError.html#ab5980e13b879db253df802b0950d1708a31ec89da55e8cd350110774ee7004f1a">Error::kSuccess</a>);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#aa9c4ec63a5252e2696c922e267b068e6">addressing_port</a> != 0) {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#aaf7fd6ae7c6a392b0a16a84473c10872">port_config_phase</a>[port.<a class="code" href="classusb_1_1xhci_1_1Port.html#a4564877db0b7ab0b5cf25e94ee406ae5">Number</a>()] = ConfigPhase::kWaitingAddressed;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> port_phase = <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#aaf7fd6ae7c6a392b0a16a84473c10872">port_config_phase</a>[port.<a class="code" href="classusb_1_1xhci_1_1Port.html#a4564877db0b7ab0b5cf25e94ee406ae5">Number</a>()];</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      <span class="keywordflow">if</span> (port_phase != ConfigPhase::kNotConnected &amp;&amp;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;          port_phase != ConfigPhase::kWaitingAddressed) {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="error_8hpp.html#a073d632b05d5b46e6f1690a7c9e0db6a">MAKE_ERROR</a>(<a class="code" href="classError.html#ab5980e13b879db253df802b0950d1708a6db265868da4306440a1f1303287b4b1">Error::kInvalidPhase</a>);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#aa9c4ec63a5252e2696c922e267b068e6">addressing_port</a> = port.<a class="code" href="classusb_1_1xhci_1_1Port.html#a4564877db0b7ab0b5cf25e94ee406ae5">Number</a>();</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#aaf7fd6ae7c6a392b0a16a84473c10872">port_config_phase</a>[port.<a class="code" href="classusb_1_1xhci_1_1Port.html#a4564877db0b7ab0b5cf25e94ee406ae5">Number</a>()] = ConfigPhase::kResettingPort;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      port.<a class="code" href="classusb_1_1xhci_1_1Port.html#a59e27e44fc516a98d611c5ceb58e923e">Reset</a>();</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="error_8hpp.html#a073d632b05d5b46e6f1690a7c9e0db6a">MAKE_ERROR</a>(<a class="code" href="classError.html#ab5980e13b879db253df802b0950d1708a31ec89da55e8cd350110774ee7004f1a">Error::kSuccess</a>);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a0df55ef7f3de1fdf4d41b304e900bcef">  115</a></span>&#160;  <a class="code" href="classError.html">Error</a> <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a0df55ef7f3de1fdf4d41b304e900bcef">EnableSlot</a>(<a class="code" href="classusb_1_1xhci_1_1Controller.html">Controller</a>&amp; xhc, <a class="code" href="classusb_1_1xhci_1_1Port.html">Port</a>&amp; port) {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> is_enabled = port.<a class="code" href="classusb_1_1xhci_1_1Port.html#a40a82c801c1ff4ece8acbcc1e99966df">IsEnabled</a>();</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> reset_completed = port.<a class="code" href="classusb_1_1xhci_1_1Port.html#a5fc6023d4bab25dece783b44e98b3288">IsPortResetChanged</a>();</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <a class="code" href="logger_8cpp.html#a7b67f04545cc3bc4793c750046527b99">Log</a>(<a class="code" href="logger_8hpp.html#aca1fd1d8935433e6ba2e3918214e07f9a5f66aaa2354d753bfaad7a8887e39216">kDebug</a>, <span class="stringliteral">&quot;EnableSlot: port.IsEnabled() = %s, port.IsPortResetChanged() = %s\n&quot;</span>,</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        is_enabled ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span>,</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        reset_completed ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span>);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">if</span> (is_enabled &amp;&amp; reset_completed) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      port.<a class="code" href="classusb_1_1xhci_1_1Port.html#ae93ca133fcdeec74b8f0375bb5a6449b">ClearPortResetChange</a>();</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#aaf7fd6ae7c6a392b0a16a84473c10872">port_config_phase</a>[port.<a class="code" href="classusb_1_1xhci_1_1Port.html#a4564877db0b7ab0b5cf25e94ee406ae5">Number</a>()] = ConfigPhase::kEnablingSlot;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <a class="code" href="unionusb_1_1xhci_1_1EnableSlotCommandTRB.html">EnableSlotCommandTRB</a> cmd{};</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      xhc.<a class="code" href="classusb_1_1xhci_1_1Controller.html#aaf211b4b41707edd8e79e7e367c6f0ca">CommandRing</a>()-&gt;<a class="code" href="classusb_1_1xhci_1_1Ring.html#a275136396db44eaf6fda0eae42faa948">Push</a>(cmd);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      xhc.<a class="code" href="classusb_1_1xhci_1_1Controller.html#a2a546530f388dd45f316e8b2a874f157">DoorbellRegisterAt</a>(0)-&gt;<a class="code" href="classusb_1_1xhci_1_1DoorbellRegister.html#a58e7a7b95db73d6a4b89aac02af41c59">Ring</a>(0);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="error_8hpp.html#a073d632b05d5b46e6f1690a7c9e0db6a">MAKE_ERROR</a>(<a class="code" href="classError.html#ab5980e13b879db253df802b0950d1708a31ec89da55e8cd350110774ee7004f1a">Error::kSuccess</a>);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#ac2690ea25de3561e14b6cd1945f92c68">  134</a></span>&#160;  <a class="code" href="classError.html">Error</a> <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#ac2690ea25de3561e14b6cd1945f92c68">AddressDevice</a>(<a class="code" href="classusb_1_1xhci_1_1Controller.html">Controller</a>&amp; xhc, uint8_t <a class="code" href="trb_8hpp.html#a6f54b893342775cdf092c6646e57c83b">port_id</a>, uint8_t <a class="code" href="trb_8hpp.html#ad7f1de8f31bd7b9ca6edcecbde59a4d5">slot_id</a>) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <a class="code" href="logger_8cpp.html#a7b67f04545cc3bc4793c750046527b99">Log</a>(<a class="code" href="logger_8hpp.html#aca1fd1d8935433e6ba2e3918214e07f9a5f66aaa2354d753bfaad7a8887e39216">kDebug</a>, <span class="stringliteral">&quot;AddressDevice: port_id = %d, slot_id = %d\n&quot;</span>, <a class="code" href="trb_8hpp.html#a6f54b893342775cdf092c6646e57c83b">port_id</a>, <a class="code" href="trb_8hpp.html#ad7f1de8f31bd7b9ca6edcecbde59a4d5">slot_id</a>);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    xhc.<a class="code" href="classusb_1_1xhci_1_1Controller.html#a78be8fedeffd23c80bdb86c293abce69">DeviceManager</a>()-&gt;<a class="code" href="classusb_1_1xhci_1_1DeviceManager.html#a3acc6a7863322303f3c7b2ca80add419">AllocDevice</a>(<a class="code" href="trb_8hpp.html#ad7f1de8f31bd7b9ca6edcecbde59a4d5">slot_id</a>, xhc.<a class="code" href="classusb_1_1xhci_1_1Controller.html#a2a546530f388dd45f316e8b2a874f157">DoorbellRegisterAt</a>(<a class="code" href="trb_8hpp.html#ad7f1de8f31bd7b9ca6edcecbde59a4d5">slot_id</a>));</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <a class="code" href="classusb_1_1xhci_1_1Device.html">Device</a>* dev = xhc.<a class="code" href="classusb_1_1xhci_1_1Controller.html#a78be8fedeffd23c80bdb86c293abce69">DeviceManager</a>()-&gt;<a class="code" href="classusb_1_1xhci_1_1DeviceManager.html#aa7593744cc8cb5673b5cd8ca71875e91">FindBySlot</a>(<a class="code" href="trb_8hpp.html#ad7f1de8f31bd7b9ca6edcecbde59a4d5">slot_id</a>);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">if</span> (dev == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="error_8hpp.html#a073d632b05d5b46e6f1690a7c9e0db6a">MAKE_ERROR</a>(<a class="code" href="classError.html#ab5980e13b879db253df802b0950d1708a780fda280e50afe40d1319860b0992b3">Error::kInvalidSlotID</a>);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    memset(&amp;dev-&gt;<a class="code" href="classusb_1_1xhci_1_1Device.html#aba61d71f163262a2d24e6b313f16582f">InputContext</a>()-&gt;<a class="code" href="structusb_1_1xhci_1_1InputContext.html#a1fa36c78c166a6e10213fb8c99edb2be">input_control_context</a>, 0,</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;           <span class="keyword">sizeof</span>(<a class="code" href="structusb_1_1xhci_1_1InputControlContext.html">InputControlContext</a>));</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> ep0_dci = <a class="code" href="structusb_1_1xhci_1_1DeviceContextIndex.html">DeviceContextIndex</a>(0, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keyword">auto</span> slot_ctx = dev-&gt;<a class="code" href="classusb_1_1xhci_1_1Device.html#aba61d71f163262a2d24e6b313f16582f">InputContext</a>()-&gt;<a class="code" href="structusb_1_1xhci_1_1InputContext.html#aec9d7b85b5806de609d729d022fbbd73">EnableSlotContext</a>();</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keyword">auto</span> ep0_ctx = dev-&gt;<a class="code" href="classusb_1_1xhci_1_1Device.html#aba61d71f163262a2d24e6b313f16582f">InputContext</a>()-&gt;<a class="code" href="structusb_1_1xhci_1_1InputContext.html#afcb2ef65c889538545743ec8c3268332">EnableEndpoint</a>(ep0_dci);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keyword">auto</span> port = xhc.<a class="code" href="classusb_1_1xhci_1_1Controller.html#aaacc1708e91093f3a0ee304181d9f287">PortAt</a>(<a class="code" href="trb_8hpp.html#a6f54b893342775cdf092c6646e57c83b">port_id</a>);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a9c32d83b4bffdb9c24178d5033fbfb21">InitializeSlotContext</a>(*slot_ctx, port);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#acf4166de45ff46cf84d073a1720edc2b">InitializeEP0Context</a>(</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        *ep0_ctx, dev-&gt;<a class="code" href="classusb_1_1xhci_1_1Device.html#a15894875f4dfe90e65ab8b2a8f8f242b">AllocTransferRing</a>(ep0_dci, 32),</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a31f446bc33b51dfa4a2fda7caf6f410f">DetermineMaxPacketSizeForControlPipe</a>(slot_ctx-&gt;bits.speed));</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    xhc.<a class="code" href="classusb_1_1xhci_1_1Controller.html#a78be8fedeffd23c80bdb86c293abce69">DeviceManager</a>()-&gt;<a class="code" href="classusb_1_1xhci_1_1DeviceManager.html#a6e7847818248a3464ab1d844f985aba9">LoadDCBAA</a>(<a class="code" href="trb_8hpp.html#ad7f1de8f31bd7b9ca6edcecbde59a4d5">slot_id</a>);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#aaf7fd6ae7c6a392b0a16a84473c10872">port_config_phase</a>[<a class="code" href="trb_8hpp.html#a6f54b893342775cdf092c6646e57c83b">port_id</a>] = ConfigPhase::kAddressingDevice;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="unionusb_1_1xhci_1_1AddressDeviceCommandTRB.html">AddressDeviceCommandTRB</a> addr_dev_cmd{dev-&gt;<a class="code" href="classusb_1_1xhci_1_1Device.html#aba61d71f163262a2d24e6b313f16582f">InputContext</a>(), <a class="code" href="trb_8hpp.html#ad7f1de8f31bd7b9ca6edcecbde59a4d5">slot_id</a>};</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    xhc.<a class="code" href="classusb_1_1xhci_1_1Controller.html#aaf211b4b41707edd8e79e7e367c6f0ca">CommandRing</a>()-&gt;<a class="code" href="classusb_1_1xhci_1_1Ring.html#a275136396db44eaf6fda0eae42faa948">Push</a>(addr_dev_cmd);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    xhc.<a class="code" href="classusb_1_1xhci_1_1Controller.html#a2a546530f388dd45f316e8b2a874f157">DoorbellRegisterAt</a>(0)-&gt;<a class="code" href="classusb_1_1xhci_1_1DoorbellRegister.html#a58e7a7b95db73d6a4b89aac02af41c59">Ring</a>(0);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="error_8hpp.html#a073d632b05d5b46e6f1690a7c9e0db6a">MAKE_ERROR</a>(<a class="code" href="classError.html#ab5980e13b879db253df802b0950d1708a31ec89da55e8cd350110774ee7004f1a">Error::kSuccess</a>);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a3886331332d12966f27e0f51f1bdea86">  169</a></span>&#160;  <a class="code" href="classError.html">Error</a> <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a3886331332d12966f27e0f51f1bdea86">InitializeDevice</a>(<a class="code" href="classusb_1_1xhci_1_1Controller.html">Controller</a>&amp; xhc, uint8_t <a class="code" href="trb_8hpp.html#a6f54b893342775cdf092c6646e57c83b">port_id</a>, uint8_t <a class="code" href="trb_8hpp.html#ad7f1de8f31bd7b9ca6edcecbde59a4d5">slot_id</a>) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <a class="code" href="logger_8cpp.html#a7b67f04545cc3bc4793c750046527b99">Log</a>(<a class="code" href="logger_8hpp.html#aca1fd1d8935433e6ba2e3918214e07f9a5f66aaa2354d753bfaad7a8887e39216">kDebug</a>, <span class="stringliteral">&quot;InitializeDevice: port_id = %d, slot_id = %d\n&quot;</span>, <a class="code" href="trb_8hpp.html#a6f54b893342775cdf092c6646e57c83b">port_id</a>, <a class="code" href="trb_8hpp.html#ad7f1de8f31bd7b9ca6edcecbde59a4d5">slot_id</a>);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keyword">auto</span> dev = xhc.<a class="code" href="classusb_1_1xhci_1_1Controller.html#a78be8fedeffd23c80bdb86c293abce69">DeviceManager</a>()-&gt;<a class="code" href="classusb_1_1xhci_1_1DeviceManager.html#aa7593744cc8cb5673b5cd8ca71875e91">FindBySlot</a>(<a class="code" href="trb_8hpp.html#ad7f1de8f31bd7b9ca6edcecbde59a4d5">slot_id</a>);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordflow">if</span> (dev == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="error_8hpp.html#a073d632b05d5b46e6f1690a7c9e0db6a">MAKE_ERROR</a>(<a class="code" href="classError.html#ab5980e13b879db253df802b0950d1708a780fda280e50afe40d1319860b0992b3">Error::kInvalidSlotID</a>);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#aaf7fd6ae7c6a392b0a16a84473c10872">port_config_phase</a>[<a class="code" href="trb_8hpp.html#a6f54b893342775cdf092c6646e57c83b">port_id</a>] = ConfigPhase::kInitializingDevice;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    dev-&gt;StartInitialize();</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="error_8hpp.html#a073d632b05d5b46e6f1690a7c9e0db6a">MAKE_ERROR</a>(<a class="code" href="classError.html#ab5980e13b879db253df802b0950d1708a31ec89da55e8cd350110774ee7004f1a">Error::kSuccess</a>);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a00375fa5c418df5ecd8f126a459f00fe">  183</a></span>&#160;  <a class="code" href="classError.html">Error</a> <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a00375fa5c418df5ecd8f126a459f00fe">CompleteConfiguration</a>(<a class="code" href="classusb_1_1xhci_1_1Controller.html">Controller</a>&amp; xhc, uint8_t <a class="code" href="trb_8hpp.html#a6f54b893342775cdf092c6646e57c83b">port_id</a>, uint8_t <a class="code" href="trb_8hpp.html#ad7f1de8f31bd7b9ca6edcecbde59a4d5">slot_id</a>) {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <a class="code" href="logger_8cpp.html#a7b67f04545cc3bc4793c750046527b99">Log</a>(<a class="code" href="logger_8hpp.html#aca1fd1d8935433e6ba2e3918214e07f9a5f66aaa2354d753bfaad7a8887e39216">kDebug</a>, <span class="stringliteral">&quot;CompleteConfiguration: port_id = %d, slot_id = %d\n&quot;</span>, <a class="code" href="trb_8hpp.html#a6f54b893342775cdf092c6646e57c83b">port_id</a>, <a class="code" href="trb_8hpp.html#ad7f1de8f31bd7b9ca6edcecbde59a4d5">slot_id</a>);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keyword">auto</span> dev = xhc.<a class="code" href="classusb_1_1xhci_1_1Controller.html#a78be8fedeffd23c80bdb86c293abce69">DeviceManager</a>()-&gt;<a class="code" href="classusb_1_1xhci_1_1DeviceManager.html#aa7593744cc8cb5673b5cd8ca71875e91">FindBySlot</a>(<a class="code" href="trb_8hpp.html#ad7f1de8f31bd7b9ca6edcecbde59a4d5">slot_id</a>);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">if</span> (dev == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="error_8hpp.html#a073d632b05d5b46e6f1690a7c9e0db6a">MAKE_ERROR</a>(<a class="code" href="classError.html#ab5980e13b879db253df802b0950d1708a780fda280e50afe40d1319860b0992b3">Error::kInvalidSlotID</a>);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    dev-&gt;OnEndpointsConfigured();</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#aaf7fd6ae7c6a392b0a16a84473c10872">port_config_phase</a>[<a class="code" href="trb_8hpp.html#a6f54b893342775cdf092c6646e57c83b">port_id</a>] = ConfigPhase::kConfigured;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="error_8hpp.html#a073d632b05d5b46e6f1690a7c9e0db6a">MAKE_ERROR</a>(<a class="code" href="classError.html#ab5980e13b879db253df802b0950d1708a31ec89da55e8cd350110774ee7004f1a">Error::kSuccess</a>);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  }</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno"><a class="line" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a8942329226c4fdfab45f0e01d4e405d2">  197</a></span>&#160;  <a class="code" href="classError.html">Error</a> <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#adc0354c535e5fbb98973fa3537f8de3c">OnEvent</a>(<a class="code" href="classusb_1_1xhci_1_1Controller.html">Controller</a>&amp; xhc, <a class="code" href="unionusb_1_1xhci_1_1PortStatusChangeEventTRB.html">PortStatusChangeEventTRB</a>&amp; trb) {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <a class="code" href="logger_8cpp.html#a7b67f04545cc3bc4793c750046527b99">Log</a>(<a class="code" href="logger_8hpp.html#aca1fd1d8935433e6ba2e3918214e07f9a5f66aaa2354d753bfaad7a8887e39216">kDebug</a>, <span class="stringliteral">&quot;PortStatusChangeEvent: port_id = %d\n&quot;</span>, trb.bits.<a class="code" href="unionusb_1_1xhci_1_1PortStatusChangeEventTRB.html#adbf802d97c1ea84d672f7b535a73031b">port_id</a>);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keyword">auto</span> <a class="code" href="trb_8hpp.html#a6f54b893342775cdf092c6646e57c83b">port_id</a> = trb.bits.<a class="code" href="unionusb_1_1xhci_1_1PortStatusChangeEventTRB.html#adbf802d97c1ea84d672f7b535a73031b">port_id</a>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keyword">auto</span> port = xhc.<a class="code" href="classusb_1_1xhci_1_1Controller.html#aaacc1708e91093f3a0ee304181d9f287">PortAt</a>(<a class="code" href="trb_8hpp.html#a6f54b893342775cdf092c6646e57c83b">port_id</a>);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#aaf7fd6ae7c6a392b0a16a84473c10872">port_config_phase</a>[<a class="code" href="trb_8hpp.html#a6f54b893342775cdf092c6646e57c83b">port_id</a>]) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">case</span> ConfigPhase::kNotConnected:</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a496b34569d293b42029c189d10f6c3fc">ResetPort</a>(xhc, port);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordflow">case</span> ConfigPhase::kResettingPort:</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a0df55ef7f3de1fdf4d41b304e900bcef">EnableSlot</a>(xhc, port);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="error_8hpp.html#a073d632b05d5b46e6f1690a7c9e0db6a">MAKE_ERROR</a>(<a class="code" href="classError.html#ab5980e13b879db253df802b0950d1708a6db265868da4306440a1f1303287b4b1">Error::kInvalidPhase</a>);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno"><a class="line" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#ac3c8c8bd71eb8140d35272f813a7e8e4">  212</a></span>&#160;  <a class="code" href="classError.html">Error</a> <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#adc0354c535e5fbb98973fa3537f8de3c">OnEvent</a>(<a class="code" href="classusb_1_1xhci_1_1Controller.html">Controller</a>&amp; xhc, <a class="code" href="unionusb_1_1xhci_1_1TransferEventTRB.html">TransferEventTRB</a>&amp; trb) {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keyword">const</span> uint8_t <a class="code" href="trb_8hpp.html#ad7f1de8f31bd7b9ca6edcecbde59a4d5">slot_id</a> = trb.bits.<a class="code" href="unionusb_1_1xhci_1_1TransferEventTRB.html#ac221bef1e210ee5620b16ccfda5c252a">slot_id</a>;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keyword">auto</span> dev = xhc.<a class="code" href="classusb_1_1xhci_1_1Controller.html#a78be8fedeffd23c80bdb86c293abce69">DeviceManager</a>()-&gt;<a class="code" href="classusb_1_1xhci_1_1DeviceManager.html#aa7593744cc8cb5673b5cd8ca71875e91">FindBySlot</a>(<a class="code" href="trb_8hpp.html#ad7f1de8f31bd7b9ca6edcecbde59a4d5">slot_id</a>);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">if</span> (dev == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="error_8hpp.html#a073d632b05d5b46e6f1690a7c9e0db6a">MAKE_ERROR</a>(<a class="code" href="classError.html#ab5980e13b879db253df802b0950d1708a780fda280e50afe40d1319860b0992b3">Error::kInvalidSlotID</a>);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> err = dev-&gt;OnTransferEventReceived(trb)) {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="trb_8hpp.html#a6f54b893342775cdf092c6646e57c83b">port_id</a> = dev-&gt;DeviceContext()-&gt;slot_context.bits.root_hub_port_num;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">if</span> (dev-&gt;IsInitialized() &amp;&amp;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#aaf7fd6ae7c6a392b0a16a84473c10872">port_config_phase</a>[<a class="code" href="trb_8hpp.html#a6f54b893342775cdf092c6646e57c83b">port_id</a>] == ConfigPhase::kInitializingDevice) {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespaceusb_1_1xhci.html#a1df54355b3da2e8c724193fc3799c482">ConfigureEndpoints</a>(xhc, *dev);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="error_8hpp.html#a073d632b05d5b46e6f1690a7c9e0db6a">MAKE_ERROR</a>(<a class="code" href="classError.html#ab5980e13b879db253df802b0950d1708a31ec89da55e8cd350110774ee7004f1a">Error::kSuccess</a>);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno"><a class="line" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#adc0354c535e5fbb98973fa3537f8de3c">  230</a></span>&#160;  <a class="code" href="classError.html">Error</a> <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#adc0354c535e5fbb98973fa3537f8de3c">OnEvent</a>(<a class="code" href="classusb_1_1xhci_1_1Controller.html">Controller</a>&amp; xhc, <a class="code" href="unionusb_1_1xhci_1_1CommandCompletionEventTRB.html">CommandCompletionEventTRB</a>&amp; trb) {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> issuer_type = trb.<a class="code" href="unionusb_1_1xhci_1_1CommandCompletionEventTRB.html#a0fa8a02da29830c069d91d5ab7a157a3">Pointer</a>()-&gt;bits.<a class="code" href="unionusb_1_1xhci_1_1TRB.html#af2ead2e68b837d442ff524d7c212294b">trb_type</a>;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="trb_8hpp.html#ad7f1de8f31bd7b9ca6edcecbde59a4d5">slot_id</a> = trb.bits.<a class="code" href="unionusb_1_1xhci_1_1CommandCompletionEventTRB.html#aed86ff980b2058e6aa82e28dfbf69594">slot_id</a>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <a class="code" href="logger_8cpp.html#a7b67f04545cc3bc4793c750046527b99">Log</a>(<a class="code" href="logger_8hpp.html#aca1fd1d8935433e6ba2e3918214e07f9a5f66aaa2354d753bfaad7a8887e39216">kDebug</a>, <span class="stringliteral">&quot;CommandCompletionEvent: slot_id = %d, issuer = %s\n&quot;</span>,</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        trb.bits.<a class="code" href="unionusb_1_1xhci_1_1CommandCompletionEventTRB.html#aed86ff980b2058e6aa82e28dfbf69594">slot_id</a>, <a class="code" href="namespaceusb_1_1xhci.html#aa1a235251b098eebf5174d6859c086c6">kTRBTypeToName</a>[issuer_type]);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">if</span> (issuer_type == <a class="code" href="unionusb_1_1xhci_1_1EnableSlotCommandTRB.html#a438ade82069187bd570750c6fe8bfe75">EnableSlotCommandTRB::Type</a>) {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#aaf7fd6ae7c6a392b0a16a84473c10872">port_config_phase</a>[<a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#aa9c4ec63a5252e2696c922e267b068e6">addressing_port</a>] != ConfigPhase::kEnablingSlot) {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="error_8hpp.html#a073d632b05d5b46e6f1690a7c9e0db6a">MAKE_ERROR</a>(<a class="code" href="classError.html#ab5980e13b879db253df802b0950d1708a6db265868da4306440a1f1303287b4b1">Error::kInvalidPhase</a>);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#ac2690ea25de3561e14b6cd1945f92c68">AddressDevice</a>(xhc, <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#aa9c4ec63a5252e2696c922e267b068e6">addressing_port</a>, <a class="code" href="trb_8hpp.html#ad7f1de8f31bd7b9ca6edcecbde59a4d5">slot_id</a>);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (issuer_type == <a class="code" href="unionusb_1_1xhci_1_1AddressDeviceCommandTRB.html#a3294682dce6439c9ded7d65465c4aa36">AddressDeviceCommandTRB::Type</a>) {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="keyword">auto</span> dev = xhc.<a class="code" href="classusb_1_1xhci_1_1Controller.html#a78be8fedeffd23c80bdb86c293abce69">DeviceManager</a>()-&gt;<a class="code" href="classusb_1_1xhci_1_1DeviceManager.html#aa7593744cc8cb5673b5cd8ca71875e91">FindBySlot</a>(<a class="code" href="trb_8hpp.html#ad7f1de8f31bd7b9ca6edcecbde59a4d5">slot_id</a>);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="keywordflow">if</span> (dev == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="error_8hpp.html#a073d632b05d5b46e6f1690a7c9e0db6a">MAKE_ERROR</a>(<a class="code" href="classError.html#ab5980e13b879db253df802b0950d1708a780fda280e50afe40d1319860b0992b3">Error::kInvalidSlotID</a>);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="keyword">auto</span> <a class="code" href="trb_8hpp.html#a6f54b893342775cdf092c6646e57c83b">port_id</a> = dev-&gt;DeviceContext()-&gt;slot_context.bits.root_hub_port_num;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="trb_8hpp.html#a6f54b893342775cdf092c6646e57c83b">port_id</a> != <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#aa9c4ec63a5252e2696c922e267b068e6">addressing_port</a>) {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="error_8hpp.html#a073d632b05d5b46e6f1690a7c9e0db6a">MAKE_ERROR</a>(<a class="code" href="classError.html#ab5980e13b879db253df802b0950d1708a6db265868da4306440a1f1303287b4b1">Error::kInvalidPhase</a>);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#aaf7fd6ae7c6a392b0a16a84473c10872">port_config_phase</a>[<a class="code" href="trb_8hpp.html#a6f54b893342775cdf092c6646e57c83b">port_id</a>] != ConfigPhase::kAddressingDevice) {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="error_8hpp.html#a073d632b05d5b46e6f1690a7c9e0db6a">MAKE_ERROR</a>(<a class="code" href="classError.html#ab5980e13b879db253df802b0950d1708a6db265868da4306440a1f1303287b4b1">Error::kInvalidPhase</a>);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      }</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#aa9c4ec63a5252e2696c922e267b068e6">addressing_port</a> = 0;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#aaf7fd6ae7c6a392b0a16a84473c10872">port_config_phase</a>.size(); ++i) {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#aaf7fd6ae7c6a392b0a16a84473c10872">port_config_phase</a>[i] == ConfigPhase::kWaitingAddressed) {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;          <span class="keyword">auto</span> port = xhc.<a class="code" href="classusb_1_1xhci_1_1Controller.html#aaacc1708e91093f3a0ee304181d9f287">PortAt</a>(i);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;          <span class="keywordflow">if</span> (<span class="keyword">auto</span> err = <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a496b34569d293b42029c189d10f6c3fc">ResetPort</a>(xhc, port); err) {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;          }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a3886331332d12966f27e0f51f1bdea86">InitializeDevice</a>(xhc, <a class="code" href="trb_8hpp.html#a6f54b893342775cdf092c6646e57c83b">port_id</a>, <a class="code" href="trb_8hpp.html#ad7f1de8f31bd7b9ca6edcecbde59a4d5">slot_id</a>);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (issuer_type == <a class="code" href="unionusb_1_1xhci_1_1ConfigureEndpointCommandTRB.html#a01fc7150bb245096301f97f93a1eecce">ConfigureEndpointCommandTRB::Type</a>) {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <span class="keyword">auto</span> dev = xhc.<a class="code" href="classusb_1_1xhci_1_1Controller.html#a78be8fedeffd23c80bdb86c293abce69">DeviceManager</a>()-&gt;<a class="code" href="classusb_1_1xhci_1_1DeviceManager.html#aa7593744cc8cb5673b5cd8ca71875e91">FindBySlot</a>(<a class="code" href="trb_8hpp.html#ad7f1de8f31bd7b9ca6edcecbde59a4d5">slot_id</a>);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <span class="keywordflow">if</span> (dev == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="error_8hpp.html#a073d632b05d5b46e6f1690a7c9e0db6a">MAKE_ERROR</a>(<a class="code" href="classError.html#ab5980e13b879db253df802b0950d1708a780fda280e50afe40d1319860b0992b3">Error::kInvalidSlotID</a>);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      <span class="keyword">auto</span> <a class="code" href="trb_8hpp.html#a6f54b893342775cdf092c6646e57c83b">port_id</a> = dev-&gt;DeviceContext()-&gt;slot_context.bits.root_hub_port_num;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#aaf7fd6ae7c6a392b0a16a84473c10872">port_config_phase</a>[<a class="code" href="trb_8hpp.html#a6f54b893342775cdf092c6646e57c83b">port_id</a>] != ConfigPhase::kConfiguringEndpoints) {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="error_8hpp.html#a073d632b05d5b46e6f1690a7c9e0db6a">MAKE_ERROR</a>(<a class="code" href="classError.html#ab5980e13b879db253df802b0950d1708a6db265868da4306440a1f1303287b4b1">Error::kInvalidPhase</a>);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      }</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a00375fa5c418df5ecd8f126a459f00fe">CompleteConfiguration</a>(xhc, <a class="code" href="trb_8hpp.html#a6f54b893342775cdf092c6646e57c83b">port_id</a>, <a class="code" href="trb_8hpp.html#ad7f1de8f31bd7b9ca6edcecbde59a4d5">slot_id</a>);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    }</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="error_8hpp.html#a073d632b05d5b46e6f1690a7c9e0db6a">MAKE_ERROR</a>(<a class="code" href="classError.html#ab5980e13b879db253df802b0950d1708a6db265868da4306440a1f1303287b4b1">Error::kInvalidPhase</a>);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno"><a class="line" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a327c7198e6f38caf6f20ebda1c9d651f">  286</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a327c7198e6f38caf6f20ebda1c9d651f">RequestHCOwnership</a>(uintptr_t mmio_base, <a class="code" href="unionusb_1_1xhci_1_1HCCPARAMS1__Bitmap.html">HCCPARAMS1_Bitmap</a> hccp) {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="classusb_1_1xhci_1_1ExtendedRegisterList.html">ExtendedRegisterList</a> extregs{ mmio_base, hccp };</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keyword">auto</span> ext_usblegsup = std::find_if(</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        extregs.begin(), extregs.end(),</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        [](<span class="keyword">auto</span>&amp; reg) { return reg.Read().bits.capability_id == 1; });</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">if</span> (ext_usblegsup == extregs.end()) {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keyword">auto</span>&amp; reg =</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="classMemMapRegister.html">MemMapRegister&lt;USBLEGSUP_Bitmap&gt;</a>&amp;<span class="keyword">&gt;</span>(*ext_usblegsup);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keyword">auto</span> r = reg.<a class="code" href="classMemMapRegister.html#a7d0631093e47440e0b414383dde241ea">Read</a>();</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">if</span> (r.bits.hc_os_owned_semaphore) {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    }</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    r.bits.hc_os_owned_semaphore = 1;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <a class="code" href="logger_8cpp.html#a7b67f04545cc3bc4793c750046527b99">Log</a>(<a class="code" href="logger_8hpp.html#aca1fd1d8935433e6ba2e3918214e07f9a5f66aaa2354d753bfaad7a8887e39216">kDebug</a>, <span class="stringliteral">&quot;waiting until OS owns xHC...\n&quot;</span>);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    reg.Write(r);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      r = reg.Read();</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    } <span class="keywordflow">while</span> (r.bits.hc_bios_owned_semaphore ||</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;             !r.bits.hc_os_owned_semaphore);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <a class="code" href="logger_8cpp.html#a7b67f04545cc3bc4793c750046527b99">Log</a>(<a class="code" href="logger_8hpp.html#aca1fd1d8935433e6ba2e3918214e07f9a5f66aaa2354d753bfaad7a8887e39216">kDebug</a>, <span class="stringliteral">&quot;OS has owned xHC\n&quot;</span>);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  }</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno"><a class="line" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a973b0fa3a5cf128fe2be864d14167079">  315</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a973b0fa3a5cf128fe2be864d14167079">SwitchEhci2Xhci</a>(<span class="keyword">const</span> <a class="code" href="structpci_1_1Device.html">pci::Device</a>&amp; xhc_dev) {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keywordtype">bool</span> intel_ehc_exist = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="namespacepci.html#a0f08f55a798464b79d71ed246e6d9f16">pci::num_device</a>; ++i) {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacepci.html#a680589a5184d51cc46b643873a8fff8e">pci::devices</a>[i].class_code.Match(0x0cu, 0x03u, 0x20u) &amp;&amp;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;          0x8086 == <a class="code" href="namespacepci.html#a9aaf9ef581a7cca6de291efc3c2036c9">pci::ReadVendorId</a>(<a class="code" href="namespacepci.html#a680589a5184d51cc46b643873a8fff8e">pci::devices</a>[i])) {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        intel_ehc_exist = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      }</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    }</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">if</span> (!intel_ehc_exist) {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      <a class="code" href="logger_8cpp.html#a7b67f04545cc3bc4793c750046527b99">Log</a>(<a class="code" href="logger_8hpp.html#aca1fd1d8935433e6ba2e3918214e07f9a5f66aaa2354d753bfaad7a8887e39216">kDebug</a>, <span class="stringliteral">&quot;Intel EHCI does not exist.\n&quot;</span>);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    uint32_t superspeed_ports = <a class="code" href="namespacepci.html#a26c366582513de13df3b528f68f375d8">pci::ReadConfReg</a>(xhc_dev, 0xdc); <span class="comment">// USB3PRM</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <a class="code" href="namespacepci.html#a8664d6328011718b702012b81065983b">pci::WriteConfReg</a>(xhc_dev, 0xd8, superspeed_ports); <span class="comment">// USB3_PSSEN</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    uint32_t ehci2xhci_ports = <a class="code" href="namespacepci.html#a26c366582513de13df3b528f68f375d8">pci::ReadConfReg</a>(xhc_dev, 0xd4); <span class="comment">// XUSB2PRM</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <a class="code" href="namespacepci.html#a8664d6328011718b702012b81065983b">pci::WriteConfReg</a>(xhc_dev, 0xd0, ehci2xhci_ports); <span class="comment">// XUSB2PR</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <a class="code" href="logger_8cpp.html#a7b67f04545cc3bc4793c750046527b99">Log</a>(<a class="code" href="logger_8hpp.html#aca1fd1d8935433e6ba2e3918214e07f9a5f66aaa2354d753bfaad7a8887e39216">kDebug</a>, <span class="stringliteral">&quot;SwitchEhci2Xhci: SS = %02, xHCI = %02x\n&quot;</span>,</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        superspeed_ports, ehci2xhci_ports);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  }</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;} <span class="comment">// namespace</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceusb_1_1xhci.html">usb::xhci</a> {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno"><a class="line" href="classusb_1_1xhci_1_1Controller.html#a64064328f197b0851feff7d436aa8aa4">  340</a></span>&#160;  <a class="code" href="classusb_1_1xhci_1_1Controller.html#a64064328f197b0851feff7d436aa8aa4">Controller::Controller</a>(uintptr_t mmio_base)</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      : mmio_base_{mmio_base},</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        cap_{<span class="keyword">reinterpret_cast&lt;</span><a class="code" href="structusb_1_1xhci_1_1CapabilityRegisters.html">CapabilityRegisters</a>*<span class="keyword">&gt;</span>(mmio_base)},</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        op_{<span class="keyword">reinterpret_cast&lt;</span><a class="code" href="structusb_1_1xhci_1_1OperationalRegisters.html">OperationalRegisters</a>*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            mmio_base + cap_-&gt;CAPLENGTH.Read())},</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        max_ports_{<span class="keyword">static_cast&lt;</span>uint8_t<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            cap_-&gt;HCSPARAMS1.Read().bits.max_ports)} {</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  }</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno"><a class="line" href="classusb_1_1xhci_1_1Controller.html#ad286e798319710177e793c792366f3de">  349</a></span>&#160;  <a class="code" href="classError.html">Error</a> <a class="code" href="classusb_1_1xhci_1_1Controller.html#ad286e798319710177e793c792366f3de">Controller::Initialize</a>() {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> err = <a class="code" href="classusb_1_1xhci_1_1Controller.html#a2446beb24b44446b5f6f0bc0334971bf">devmgr_</a>.<a class="code" href="classusb_1_1xhci_1_1DeviceManager.html#a572c00b6a3521391740ce2ce4308beb3">Initialize</a>(<a class="code" href="classusb_1_1xhci_1_1Controller.html#a1caa54bb6647aede42e82a0e6e6329b9">kDeviceSize</a>)) {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a327c7198e6f38caf6f20ebda1c9d651f">RequestHCOwnership</a>(<a class="code" href="classusb_1_1xhci_1_1Controller.html#a0fab568367b368dba57599a94a43d27d">mmio_base_</a>, <a class="code" href="classusb_1_1xhci_1_1Controller.html#a984da6949804e2c6920d9c1d9d915dec">cap_</a>-&gt;<a class="code" href="structusb_1_1xhci_1_1CapabilityRegisters.html#a54f0f025cf56f568cba9d8668e673894">HCCPARAMS1</a>.Read());</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keyword">auto</span> usbcmd = <a class="code" href="classusb_1_1xhci_1_1Controller.html#a3d88b629fb17a599e891db31b8bcc717">op_</a>-&gt;<a class="code" href="structusb_1_1xhci_1_1OperationalRegisters.html#a230b2d13015055a0aa0e427ff99bbf6d">USBCMD</a>.Read();</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    usbcmd.bits.interrupter_enable = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    usbcmd.bits.host_system_error_enable = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    usbcmd.bits.enable_wrap_event = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="comment">// Host controller must be halted before resetting it.</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classusb_1_1xhci_1_1Controller.html#a3d88b629fb17a599e891db31b8bcc717">op_</a>-&gt;<a class="code" href="structusb_1_1xhci_1_1OperationalRegisters.html#a0402e3b6a108d00eeeb66f7ddeb4077a">USBSTS</a>.Read().bits.host_controller_halted) {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      usbcmd.bits.run_stop = <span class="keyword">false</span>;  <span class="comment">// stop</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <a class="code" href="classusb_1_1xhci_1_1Controller.html#a3d88b629fb17a599e891db31b8bcc717">op_</a>-&gt;<a class="code" href="structusb_1_1xhci_1_1OperationalRegisters.html#a230b2d13015055a0aa0e427ff99bbf6d">USBCMD</a>.Write(usbcmd);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordflow">while</span> (!<a class="code" href="classusb_1_1xhci_1_1Controller.html#a3d88b629fb17a599e891db31b8bcc717">op_</a>-&gt;<a class="code" href="structusb_1_1xhci_1_1OperationalRegisters.html#a0402e3b6a108d00eeeb66f7ddeb4077a">USBSTS</a>.Read().bits.host_controller_halted);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="comment">// Reset controller</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    usbcmd = <a class="code" href="classusb_1_1xhci_1_1Controller.html#a3d88b629fb17a599e891db31b8bcc717">op_</a>-&gt;<a class="code" href="structusb_1_1xhci_1_1OperationalRegisters.html#a230b2d13015055a0aa0e427ff99bbf6d">USBCMD</a>.Read();</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    usbcmd.bits.host_controller_reset = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <a class="code" href="classusb_1_1xhci_1_1Controller.html#a3d88b629fb17a599e891db31b8bcc717">op_</a>-&gt;<a class="code" href="structusb_1_1xhci_1_1OperationalRegisters.html#a230b2d13015055a0aa0e427ff99bbf6d">USBCMD</a>.Write(usbcmd);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="classusb_1_1xhci_1_1Controller.html#a3d88b629fb17a599e891db31b8bcc717">op_</a>-&gt;<a class="code" href="structusb_1_1xhci_1_1OperationalRegisters.html#a230b2d13015055a0aa0e427ff99bbf6d">USBCMD</a>.Read().bits.host_controller_reset);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="classusb_1_1xhci_1_1Controller.html#a3d88b629fb17a599e891db31b8bcc717">op_</a>-&gt;<a class="code" href="structusb_1_1xhci_1_1OperationalRegisters.html#a0402e3b6a108d00eeeb66f7ddeb4077a">USBSTS</a>.Read().bits.controller_not_ready);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <a class="code" href="logger_8cpp.html#a7b67f04545cc3bc4793c750046527b99">Log</a>(<a class="code" href="logger_8hpp.html#aca1fd1d8935433e6ba2e3918214e07f9a5f66aaa2354d753bfaad7a8887e39216">kDebug</a>, <span class="stringliteral">&quot;MaxSlots: %u\n&quot;</span>, <a class="code" href="classusb_1_1xhci_1_1Controller.html#a984da6949804e2c6920d9c1d9d915dec">cap_</a>-&gt;<a class="code" href="structusb_1_1xhci_1_1CapabilityRegisters.html#aa4b9e5d2280f6e7f50b415cf340c3dd5">HCSPARAMS1</a>.Read().bits.max_device_slots);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="comment">// Set &quot;Max Slots Enabled&quot; field in CONFIG.</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keyword">auto</span> config = <a class="code" href="classusb_1_1xhci_1_1Controller.html#a3d88b629fb17a599e891db31b8bcc717">op_</a>-&gt;<a class="code" href="structusb_1_1xhci_1_1OperationalRegisters.html#ad33f67ae240a747bd535c55c01bb56e0">CONFIG</a>.Read();</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    config.bits.max_device_slots_enabled = <a class="code" href="classusb_1_1xhci_1_1Controller.html#a1caa54bb6647aede42e82a0e6e6329b9">kDeviceSize</a>;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <a class="code" href="classusb_1_1xhci_1_1Controller.html#a3d88b629fb17a599e891db31b8bcc717">op_</a>-&gt;<a class="code" href="structusb_1_1xhci_1_1OperationalRegisters.html#ad33f67ae240a747bd535c55c01bb56e0">CONFIG</a>.Write(config);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keyword">auto</span> hcsparams2 = <a class="code" href="classusb_1_1xhci_1_1Controller.html#a984da6949804e2c6920d9c1d9d915dec">cap_</a>-&gt;<a class="code" href="structusb_1_1xhci_1_1CapabilityRegisters.html#a8be37013d553dc20e609238a73c05e44">HCSPARAMS2</a>.Read();</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keyword">const</span> uint16_t max_scratchpad_buffers =</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      hcsparams2.bits.max_scratchpad_buffers_low</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      | (hcsparams2.bits.max_scratchpad_buffers_high &lt;&lt; 5);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">if</span> (max_scratchpad_buffers &gt; 0) {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      <span class="keyword">auto</span> scratchpad_buf_arr = AllocArray&lt;void*&gt;(max_scratchpad_buffers, 64, 4096);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; max_scratchpad_buffers; ++i) {</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        scratchpad_buf_arr[i] = <a class="code" href="namespaceusb.html#a86621f971b6f135f738ad641bcf879c0">AllocMem</a>(4096, 4096, 4096);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <a class="code" href="logger_8cpp.html#a7b67f04545cc3bc4793c750046527b99">Log</a>(<a class="code" href="logger_8hpp.html#aca1fd1d8935433e6ba2e3918214e07f9a5f66aaa2354d753bfaad7a8887e39216">kDebug</a>, <span class="stringliteral">&quot;scratchpad buffer array %d = %p\n&quot;</span>,</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            i, scratchpad_buf_arr[i]);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      <a class="code" href="classusb_1_1xhci_1_1Controller.html#a2446beb24b44446b5f6f0bc0334971bf">devmgr_</a>.<a class="code" href="classusb_1_1xhci_1_1DeviceManager.html#a4fa25d1a6fd5c160ac9933003fed58c9">DeviceContexts</a>()[0] = <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="structusb_1_1xhci_1_1DeviceContext.html">DeviceContext</a>*<span class="keyword">&gt;</span>(scratchpad_buf_arr);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <a class="code" href="logger_8cpp.html#a7b67f04545cc3bc4793c750046527b99">Log</a>(<a class="code" href="logger_8hpp.html#aca1fd1d8935433e6ba2e3918214e07f9af5f198c05e424cf59cf410fb0de5591e">kInfo</a>, <span class="stringliteral">&quot;wrote scratchpad buffer array %p to dev ctx array 0\n&quot;</span>,</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;          scratchpad_buf_arr);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <a class="code" href="unionusb_1_1xhci_1_1DCBAAP__Bitmap.html">DCBAAP_Bitmap</a> dcbaap{};</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    dcbaap.<a class="code" href="unionusb_1_1xhci_1_1DCBAAP__Bitmap.html#a2c126106ec6cee6f687ca0e509d97e1d">SetPointer</a>(<span class="keyword">reinterpret_cast&lt;</span>uint64_t<span class="keyword">&gt;</span>(<a class="code" href="classusb_1_1xhci_1_1Controller.html#a2446beb24b44446b5f6f0bc0334971bf">devmgr_</a>.<a class="code" href="classusb_1_1xhci_1_1DeviceManager.html#a4fa25d1a6fd5c160ac9933003fed58c9">DeviceContexts</a>()));</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <a class="code" href="classusb_1_1xhci_1_1Controller.html#a3d88b629fb17a599e891db31b8bcc717">op_</a>-&gt;<a class="code" href="structusb_1_1xhci_1_1OperationalRegisters.html#ab5d2b3c02627dc25ffc3fed7393f3ef0">DCBAAP</a>.Write(dcbaap);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keyword">auto</span> primary_interrupter = &amp;<a class="code" href="classusb_1_1xhci_1_1Controller.html#aa1d1fd681a42199bca4ce5d613817b84">InterrupterRegisterSets</a>()[0];</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> err = <a class="code" href="classusb_1_1xhci_1_1Controller.html#a7110699c627752ef993726918959a5f3">cr_</a>.<a class="code" href="classusb_1_1xhci_1_1Ring.html#a5e4624913e000bc06eb11823160bab2c">Initialize</a>(32)) {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> err = <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a4133327bd6ec5fac64f5e44a96751671">RegisterCommandRing</a>(&amp;<a class="code" href="classusb_1_1xhci_1_1Controller.html#a7110699c627752ef993726918959a5f3">cr_</a>, &amp;<a class="code" href="classusb_1_1xhci_1_1Controller.html#a3d88b629fb17a599e891db31b8bcc717">op_</a>-&gt;<a class="code" href="structusb_1_1xhci_1_1OperationalRegisters.html#ac8d0f2fcd511074712bfd774eb6aaf13">CRCR</a>)) {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <span class="keywordflow">return</span> err; }</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> err = <a class="code" href="classusb_1_1xhci_1_1Controller.html#a73e0b2503d19e6e554c45d3722e97571">er_</a>.<a class="code" href="classusb_1_1xhci_1_1EventRing.html#a607645ceb094980f5d3b8dfe855f028c">Initialize</a>(32, primary_interrupter)) {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="comment">// Enable interrupt for the primary interrupter</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keyword">auto</span> iman = primary_interrupter-&gt;IMAN.Read();</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    iman.bits.interrupt_pending = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    iman.bits.interrupt_enable = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    primary_interrupter-&gt;IMAN.Write(iman);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="comment">// Enable interrupt for the controller</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    usbcmd = <a class="code" href="classusb_1_1xhci_1_1Controller.html#a3d88b629fb17a599e891db31b8bcc717">op_</a>-&gt;<a class="code" href="structusb_1_1xhci_1_1OperationalRegisters.html#a230b2d13015055a0aa0e427ff99bbf6d">USBCMD</a>.Read();</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    usbcmd.bits.interrupter_enable = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <a class="code" href="classusb_1_1xhci_1_1Controller.html#a3d88b629fb17a599e891db31b8bcc717">op_</a>-&gt;<a class="code" href="structusb_1_1xhci_1_1OperationalRegisters.html#a230b2d13015055a0aa0e427ff99bbf6d">USBCMD</a>.Write(usbcmd);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="error_8hpp.html#a073d632b05d5b46e6f1690a7c9e0db6a">MAKE_ERROR</a>(<a class="code" href="classError.html#ab5980e13b879db253df802b0950d1708a31ec89da55e8cd350110774ee7004f1a">Error::kSuccess</a>);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  }</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno"><a class="line" href="classusb_1_1xhci_1_1Controller.html#af33839b864df11916aacbda68c51525d">  425</a></span>&#160;  <a class="code" href="classError.html">Error</a> <a class="code" href="classusb_1_1xhci_1_1Controller.html#af33839b864df11916aacbda68c51525d">Controller::Run</a>() {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="comment">// Run the controller</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keyword">auto</span> usbcmd = <a class="code" href="classusb_1_1xhci_1_1Controller.html#a3d88b629fb17a599e891db31b8bcc717">op_</a>-&gt;<a class="code" href="structusb_1_1xhci_1_1OperationalRegisters.html#a230b2d13015055a0aa0e427ff99bbf6d">USBCMD</a>.Read();</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    usbcmd.bits.run_stop = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <a class="code" href="classusb_1_1xhci_1_1Controller.html#a3d88b629fb17a599e891db31b8bcc717">op_</a>-&gt;<a class="code" href="structusb_1_1xhci_1_1OperationalRegisters.html#a230b2d13015055a0aa0e427ff99bbf6d">USBCMD</a>.Write(usbcmd);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <a class="code" href="classusb_1_1xhci_1_1Controller.html#a3d88b629fb17a599e891db31b8bcc717">op_</a>-&gt;<a class="code" href="structusb_1_1xhci_1_1OperationalRegisters.html#a230b2d13015055a0aa0e427ff99bbf6d">USBCMD</a>.Read();</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="classusb_1_1xhci_1_1Controller.html#a3d88b629fb17a599e891db31b8bcc717">op_</a>-&gt;<a class="code" href="structusb_1_1xhci_1_1OperationalRegisters.html#a0402e3b6a108d00eeeb66f7ddeb4077a">USBSTS</a>.Read().bits.host_controller_halted);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="error_8hpp.html#a073d632b05d5b46e6f1690a7c9e0db6a">MAKE_ERROR</a>(<a class="code" href="classError.html#ab5980e13b879db253df802b0950d1708a31ec89da55e8cd350110774ee7004f1a">Error::kSuccess</a>);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno"><a class="line" href="classusb_1_1xhci_1_1Controller.html#a2a546530f388dd45f316e8b2a874f157">  437</a></span>&#160;  <a class="code" href="classusb_1_1xhci_1_1DoorbellRegister.html">DoorbellRegister</a>* <a class="code" href="classusb_1_1xhci_1_1Controller.html#a2a546530f388dd45f316e8b2a874f157">Controller::DoorbellRegisterAt</a>(uint8_t <a class="code" href="setupdata_8hpp.html#a852b86a2eaee9852ada7a43e61e311a2">index</a>) {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keywordflow">return</span> &amp;<a class="code" href="classusb_1_1xhci_1_1Controller.html#ad1ce8d921969f026d9d65cfcbea02fc4">DoorbellRegisters</a>()[<a class="code" href="setupdata_8hpp.html#a852b86a2eaee9852ada7a43e61e311a2">index</a>];</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  }</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; </div>
<div class="line"><a name="l00441"></a><span class="lineno"><a class="line" href="namespaceusb_1_1xhci.html#ac2787bcc15dfa613708459412c73351f">  441</a></span>&#160;  <a class="code" href="classError.html">Error</a> <a class="code" href="namespaceusb_1_1xhci.html#ac2787bcc15dfa613708459412c73351f">ConfigurePort</a>(<a class="code" href="classusb_1_1xhci_1_1Controller.html">Controller</a>&amp; xhc, <a class="code" href="classusb_1_1xhci_1_1Port.html">Port</a>&amp; port) {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#aaf7fd6ae7c6a392b0a16a84473c10872">port_config_phase</a>[port.<a class="code" href="classusb_1_1xhci_1_1Port.html#a4564877db0b7ab0b5cf25e94ee406ae5">Number</a>()] == ConfigPhase::kNotConnected) {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a496b34569d293b42029c189d10f6c3fc">ResetPort</a>(xhc, port);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    }</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="error_8hpp.html#a073d632b05d5b46e6f1690a7c9e0db6a">MAKE_ERROR</a>(<a class="code" href="classError.html#ab5980e13b879db253df802b0950d1708a31ec89da55e8cd350110774ee7004f1a">Error::kSuccess</a>);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  }</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno"><a class="line" href="namespaceusb_1_1xhci.html#a1df54355b3da2e8c724193fc3799c482">  448</a></span>&#160;  <a class="code" href="classError.html">Error</a> <a class="code" href="namespaceusb_1_1xhci.html#a1df54355b3da2e8c724193fc3799c482">ConfigureEndpoints</a>(<a class="code" href="classusb_1_1xhci_1_1Controller.html">Controller</a>&amp; xhc, <a class="code" href="classusb_1_1xhci_1_1Device.html">Device</a>&amp; dev) {</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> configs = dev.<a class="code" href="classusb_1_1Device.html#ab262c59ce7ee3cbdb883ed694d9b7a8c">EndpointConfigs</a>();</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> len = dev.<a class="code" href="classusb_1_1Device.html#a39e8443ae33b9513c6e993bd29f55c3b">NumEndpointConfigs</a>();</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    memset(&amp;dev.<a class="code" href="classusb_1_1xhci_1_1Device.html#aba61d71f163262a2d24e6b313f16582f">InputContext</a>()-&gt;<a class="code" href="structusb_1_1xhci_1_1InputContext.html#a1fa36c78c166a6e10213fb8c99edb2be">input_control_context</a>, 0, <span class="keyword">sizeof</span>(<a class="code" href="structusb_1_1xhci_1_1InputControlContext.html">InputControlContext</a>));</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    memcpy(&amp;dev.<a class="code" href="classusb_1_1xhci_1_1Device.html#aba61d71f163262a2d24e6b313f16582f">InputContext</a>()-&gt;<a class="code" href="structusb_1_1xhci_1_1InputContext.html#a4eccaf8527b5176c55cb4b206722a0a2">slot_context</a>,</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;           &amp;dev.<a class="code" href="classusb_1_1xhci_1_1Device.html#a8e4e103ef63a74cecf3923ea1419a4cc">DeviceContext</a>()-&gt;<a class="code" href="structusb_1_1xhci_1_1DeviceContext.html#a399f9038cc97aa2d5da471d39659b7ca">slot_context</a>, <span class="keyword">sizeof</span>(<a class="code" href="unionusb_1_1xhci_1_1SlotContext.html">SlotContext</a>));</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keyword">auto</span> slot_ctx = dev.<a class="code" href="classusb_1_1xhci_1_1Device.html#aba61d71f163262a2d24e6b313f16582f">InputContext</a>()-&gt;<a class="code" href="structusb_1_1xhci_1_1InputContext.html#aec9d7b85b5806de609d729d022fbbd73">EnableSlotContext</a>();</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    slot_ctx-&gt;bits.<a class="code" href="unionusb_1_1xhci_1_1SlotContext.html#a15b0e0fd6dd66c92efca19bd9682989d">context_entries</a> = 31;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="trb_8hpp.html#a6f54b893342775cdf092c6646e57c83b">port_id</a>{dev.<a class="code" href="classusb_1_1xhci_1_1Device.html#a8e4e103ef63a74cecf3923ea1419a4cc">DeviceContext</a>()-&gt;<a class="code" href="structusb_1_1xhci_1_1DeviceContext.html#a399f9038cc97aa2d5da471d39659b7ca">slot_context</a>.bits.<a class="code" href="unionusb_1_1xhci_1_1SlotContext.html#a9418d01500c3f8e2edd1ddec34e824f3">root_hub_port_num</a>};</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="registers_8hpp.html#a38938c329191ddb6948c0def9e183d54">port_speed</a>{xhc.<a class="code" href="classusb_1_1xhci_1_1Controller.html#aaacc1708e91093f3a0ee304181d9f287">PortAt</a>(<a class="code" href="trb_8hpp.html#a6f54b893342775cdf092c6646e57c83b">port_id</a>).<a class="code" href="classusb_1_1xhci_1_1Port.html#ac8a04170075fd99ee806fc573598bb75">Speed</a>()};</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="registers_8hpp.html#a38938c329191ddb6948c0def9e183d54">port_speed</a> == 0 || <a class="code" href="registers_8hpp.html#a38938c329191ddb6948c0def9e183d54">port_speed</a> &gt; <a class="code" href="namespaceusb_1_1xhci.html#abbe999f1d0f28d7732ffab1156028e52">kSuperSpeedPlus</a>) {</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="error_8hpp.html#a073d632b05d5b46e6f1690a7c9e0db6a">MAKE_ERROR</a>(<a class="code" href="classError.html#ab5980e13b879db253df802b0950d1708a8509b5d0563ed785bdebe036b13305ea">Error::kUnknownXHCISpeedID</a>);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    }</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keyword">auto</span> convert_interval{</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      (<a class="code" href="registers_8hpp.html#a38938c329191ddb6948c0def9e183d54">port_speed</a> == <a class="code" href="namespaceusb_1_1xhci.html#a3fed14a82ae8237cc50d33beb2193ac3">kFullSpeed</a> || <a class="code" href="registers_8hpp.html#a38938c329191ddb6948c0def9e183d54">port_speed</a> == <a class="code" href="namespaceusb_1_1xhci.html#a5c3fa0788ed73d1539ffd921da3bc99f">kLowSpeed</a>)</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      ? [](<a class="code" href="namespaceusb.html#a5b351fdfba906c847bacc9c8d2a808eb">EndpointType</a> <a class="code" href="interrupt_8hpp.html#a05248a33688a88a6e8f8a03c729e308e">type</a>, <span class="keywordtype">int</span> <a class="code" href="descriptor_8hpp.html#acd9ed1ccc44de55e1d3eff5569663695">interval</a>) { <span class="comment">// for FS, LS</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="interrupt_8hpp.html#a05248a33688a88a6e8f8a03c729e308e">type</a> == <a class="code" href="namespaceusb.html#a5b351fdfba906c847bacc9c8d2a808eba80f5016e6d907e2222f5ee8d00eea0d6">EndpointType::kIsochronous</a>) <span class="keywordflow">return</span> <a class="code" href="descriptor_8hpp.html#acd9ed1ccc44de55e1d3eff5569663695">interval</a> + 2;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">return</span> <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#ac8a768fa737e790c084fce025ce4695f">MostSignificantBit</a>(<a class="code" href="descriptor_8hpp.html#acd9ed1ccc44de55e1d3eff5569663695">interval</a>) + 3;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      }</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      : [](<a class="code" href="namespaceusb.html#a5b351fdfba906c847bacc9c8d2a808eb">EndpointType</a> <a class="code" href="interrupt_8hpp.html#a05248a33688a88a6e8f8a03c729e308e">type</a>, <span class="keywordtype">int</span> <a class="code" href="descriptor_8hpp.html#acd9ed1ccc44de55e1d3eff5569663695">interval</a>) { <span class="comment">// for HS, SS, SSP</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="descriptor_8hpp.html#acd9ed1ccc44de55e1d3eff5569663695">interval</a> - 1;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      }};</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160; </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; len; ++i) {</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      <span class="keyword">const</span> <a class="code" href="structusb_1_1xhci_1_1DeviceContextIndex.html">DeviceContextIndex</a> ep_dci{configs[i].ep_id};</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      <span class="keyword">auto</span> ep_ctx = dev.<a class="code" href="classusb_1_1xhci_1_1Device.html#aba61d71f163262a2d24e6b313f16582f">InputContext</a>()-&gt;<a class="code" href="structusb_1_1xhci_1_1InputContext.html#afcb2ef65c889538545743ec8c3268332">EnableEndpoint</a>(ep_dci);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      <span class="keywordflow">switch</span> (configs[i].<a class="code" href="context_8hpp.html#aa739134b2dd78eb8819e8cd544af531e">ep_type</a>) {</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespaceusb.html#a5b351fdfba906c847bacc9c8d2a808ebad206dcabae22951821cfb7585b4d2deb">EndpointType::kControl</a>:</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        ep_ctx-&gt;bits.ep_type = 4;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespaceusb.html#a5b351fdfba906c847bacc9c8d2a808eba80f5016e6d907e2222f5ee8d00eea0d6">EndpointType::kIsochronous</a>:</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        ep_ctx-&gt;bits.ep_type = configs[i].ep_id.IsIn() ? 5 : 1;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespaceusb.html#a5b351fdfba906c847bacc9c8d2a808eba2c4702e16e57dd53bc4e05df8431a171">EndpointType::kBulk</a>:</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        ep_ctx-&gt;bits.ep_type = configs[i].ep_id.IsIn() ? 6 : 2;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespaceusb.html#a5b351fdfba906c847bacc9c8d2a808eba5226558f5ccca12b5009c9e2f97d50ae">EndpointType::kInterrupt</a>:</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        ep_ctx-&gt;bits.ep_type = configs[i].ep_id.IsIn() ? 7 : 3;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      }</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      ep_ctx-&gt;bits.max_packet_size = configs[i].max_packet_size;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      ep_ctx-&gt;bits.interval = convert_interval(configs[i].<a class="code" href="context_8hpp.html#aa739134b2dd78eb8819e8cd544af531e">ep_type</a>, configs[i].<a class="code" href="descriptor_8hpp.html#acd9ed1ccc44de55e1d3eff5569663695">interval</a>);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      ep_ctx-&gt;bits.average_trb_length = 1;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      <span class="keyword">auto</span> tr = dev.<a class="code" href="classusb_1_1xhci_1_1Device.html#a15894875f4dfe90e65ab8b2a8f8f242b">AllocTransferRing</a>(ep_dci, 32);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      ep_ctx-&gt;SetTransferRingBuffer(tr-&gt;Buffer());</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      ep_ctx-&gt;bits.dequeue_cycle_state = 1;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      ep_ctx-&gt;bits.max_primary_streams = 0;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      ep_ctx-&gt;bits.mult = 0;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      ep_ctx-&gt;bits.error_count = 3;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    }</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160; </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#aaf7fd6ae7c6a392b0a16a84473c10872">port_config_phase</a>[<a class="code" href="trb_8hpp.html#a6f54b893342775cdf092c6646e57c83b">port_id</a>] = ConfigPhase::kConfiguringEndpoints;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <a class="code" href="unionusb_1_1xhci_1_1ConfigureEndpointCommandTRB.html">ConfigureEndpointCommandTRB</a> cmd{dev.<a class="code" href="classusb_1_1xhci_1_1Device.html#aba61d71f163262a2d24e6b313f16582f">InputContext</a>(), dev.<a class="code" href="classusb_1_1xhci_1_1Device.html#a6726f0604ce19fcf4a5fb568f89f9ee5">SlotID</a>()};</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    xhc.<a class="code" href="classusb_1_1xhci_1_1Controller.html#aaf211b4b41707edd8e79e7e367c6f0ca">CommandRing</a>()-&gt;<a class="code" href="classusb_1_1xhci_1_1Ring.html#a275136396db44eaf6fda0eae42faa948">Push</a>(cmd);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    xhc.<a class="code" href="classusb_1_1xhci_1_1Controller.html#a2a546530f388dd45f316e8b2a874f157">DoorbellRegisterAt</a>(0)-&gt;<a class="code" href="classusb_1_1xhci_1_1DoorbellRegister.html#a58e7a7b95db73d6a4b89aac02af41c59">Ring</a>(0);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="error_8hpp.html#a073d632b05d5b46e6f1690a7c9e0db6a">MAKE_ERROR</a>(<a class="code" href="classError.html#ab5980e13b879db253df802b0950d1708a31ec89da55e8cd350110774ee7004f1a">Error::kSuccess</a>);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  }</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno"><a class="line" href="namespaceusb_1_1xhci.html#a915e51b4a22646799d4dfce16e5d4e69">  513</a></span>&#160;  <a class="code" href="classError.html">Error</a> <a class="code" href="namespaceusb_1_1xhci.html#a915e51b4a22646799d4dfce16e5d4e69">ProcessEvent</a>(<a class="code" href="classusb_1_1xhci_1_1Controller.html">Controller</a>&amp; xhc) {</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordflow">if</span> (!xhc.<a class="code" href="classusb_1_1xhci_1_1Controller.html#ac9baf870543d94dd44c996c067f95337">PrimaryEventRing</a>()-&gt;<a class="code" href="classusb_1_1xhci_1_1EventRing.html#a06b3c69968a49e478cf72d2607c2d442">HasFront</a>()) {</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="error_8hpp.html#a073d632b05d5b46e6f1690a7c9e0db6a">MAKE_ERROR</a>(<a class="code" href="classError.html#ab5980e13b879db253df802b0950d1708a31ec89da55e8cd350110774ee7004f1a">Error::kSuccess</a>);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    }</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <a class="code" href="classError.html">Error</a> err = <a class="code" href="error_8hpp.html#a073d632b05d5b46e6f1690a7c9e0db6a">MAKE_ERROR</a>(<a class="code" href="classError.html#ab5980e13b879db253df802b0950d1708ad7f679c6327539167ef4705938babbf6">Error::kNotImplemented</a>);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="keyword">auto</span> event_trb = xhc.<a class="code" href="classusb_1_1xhci_1_1Controller.html#ac9baf870543d94dd44c996c067f95337">PrimaryEventRing</a>()-&gt;<a class="code" href="classusb_1_1xhci_1_1EventRing.html#ac49734ca46233e2410946aa68ac7494c">Front</a>();</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> trb = TRBDynamicCast&lt;TransferEventTRB&gt;(event_trb)) {</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      err = <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#adc0354c535e5fbb98973fa3537f8de3c">OnEvent</a>(xhc, *trb);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">auto</span> trb = TRBDynamicCast&lt;PortStatusChangeEventTRB&gt;(event_trb)) {</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      err = <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#adc0354c535e5fbb98973fa3537f8de3c">OnEvent</a>(xhc, *trb);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">auto</span> trb = TRBDynamicCast&lt;CommandCompletionEventTRB&gt;(event_trb)) {</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      err = <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#adc0354c535e5fbb98973fa3537f8de3c">OnEvent</a>(xhc, *trb);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    }</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    xhc.<a class="code" href="classusb_1_1xhci_1_1Controller.html#ac9baf870543d94dd44c996c067f95337">PrimaryEventRing</a>()-&gt;<a class="code" href="classusb_1_1xhci_1_1EventRing.html#a75b7ddd0e08959be4e86db7a6b75dfb7">Pop</a>();</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  }</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno"><a class="line" href="namespaceusb_1_1xhci.html#a73a5104eb2e91a7bef877aa7431a6235">  532</a></span>&#160;  <a class="code" href="classusb_1_1xhci_1_1Controller.html">Controller</a>* <a class="code" href="namespaceusb_1_1xhci.html#a73a5104eb2e91a7bef877aa7431a6235">controller</a>;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; </div>
<div class="line"><a name="l00534"></a><span class="lineno"><a class="line" href="namespaceusb_1_1xhci.html#a230710c277871c2a8fb820799c2e05e6">  534</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespaceusb_1_1xhci.html#a230710c277871c2a8fb820799c2e05e6">Initialize</a>() {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="comment">// Intel製を優先してxHCを探す</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <a class="code" href="structpci_1_1Device.html">pci::Device</a>* xhc_dev = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="namespacepci.html#a0f08f55a798464b79d71ed246e6d9f16">pci::num_device</a>; ++i) {</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacepci.html#a680589a5184d51cc46b643873a8fff8e">pci::devices</a>[i].class_code.Match(0x0cu, 0x03u, 0x30u)) {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        xhc_dev = &amp;<a class="code" href="namespacepci.html#a680589a5184d51cc46b643873a8fff8e">pci::devices</a>[i];</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160; </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <span class="keywordflow">if</span> (0x8086 == <a class="code" href="namespacepci.html#a9aaf9ef581a7cca6de291efc3c2036c9">pci::ReadVendorId</a>(*xhc_dev)) {</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        }</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      }</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    }</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160; </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="keywordflow">if</span> (xhc_dev) {</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      <a class="code" href="logger_8cpp.html#a7b67f04545cc3bc4793c750046527b99">Log</a>(<a class="code" href="logger_8hpp.html#aca1fd1d8935433e6ba2e3918214e07f9af5f198c05e424cf59cf410fb0de5591e">kInfo</a>, <span class="stringliteral">&quot;xHC has been found: %d.%d.%d\n&quot;</span>,</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;          xhc_dev-&gt;<a class="code" href="structpci_1_1Device.html#a903a6f7e90f79bea39114e81e3fbfec0">bus</a>, xhc_dev-&gt;<a class="code" href="structpci_1_1Device.html#acd5ec13790bca0e4c115314916090a31">device</a>, xhc_dev-&gt;<a class="code" href="structpci_1_1Device.html#af8c4acf8269a8dd4203d10d7f05218b4">function</a>);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      <a class="code" href="logger_8cpp.html#a7b67f04545cc3bc4793c750046527b99">Log</a>(<a class="code" href="logger_8hpp.html#aca1fd1d8935433e6ba2e3918214e07f9aacb2c04376333850bff6fb1065c0c171">kError</a>, <span class="stringliteral">&quot;xHC has not been found.\n&quot;</span>);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      exit(1);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    }</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160; </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keyword">const</span> uint8_t bsp_local_apic_id =</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      *<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span>uint32_t*<span class="keyword">&gt;</span>(0xfee00020) &gt;&gt; 24;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <a class="code" href="namespacepci.html#af57068dc97191fcc3cf5b5d4b201e433">pci::ConfigureMSIFixedDestination</a>(</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        *xhc_dev, bsp_local_apic_id,</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <a class="code" href="namespacepci.html#a4ccca51f7e92c40fc147119885a6a816a42f75919993cdefe1b30d08ca7972e88">pci::MSITriggerMode::kLevel</a>, <a class="code" href="namespacepci.html#a2d0f757b2827f9266bebbd4db56b2bcaa826888a09763de7e2a9f60eb85d88b24">pci::MSIDeliveryMode::kFixed</a>,</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <a class="code" href="classInterruptVector.html#adb64aa6edf43a001911d6668066c752aafbc6ff3f8c4bc7033488f5f58a1f912a">InterruptVector::kXHCI</a>, 0);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160; </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="comment">// Read BAR (Base Address Register)</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="keyword">const</span> <a class="code" href="structWithError.html">WithError&lt;uint64_t&gt;</a> xhc_bar = <a class="code" href="namespacepci.html#a246e1675be11897121479241ac631948">pci::ReadBar</a>(*xhc_dev, 0);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <a class="code" href="logger_8cpp.html#a7b67f04545cc3bc4793c750046527b99">Log</a>(<a class="code" href="logger_8hpp.html#aca1fd1d8935433e6ba2e3918214e07f9a5f66aaa2354d753bfaad7a8887e39216">kDebug</a>, <span class="stringliteral">&quot;ReadBar: %s\n&quot;</span>, xhc_bar.<a class="code" href="structWithError.html#a3e6de5f795254e0a40ed974a636b563a">error</a>.<a class="code" href="classError.html#a4bdebc8c23b31662aeb384a9d437717d">Name</a>());</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="keyword">const</span> uint64_t xhc_mmio_base = xhc_bar.<a class="code" href="structWithError.html#a82883238fe2ca226301fbe88411ab67c">value</a> &amp; ~static_cast&lt;uint64_t&gt;(0xf);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <a class="code" href="logger_8cpp.html#a7b67f04545cc3bc4793c750046527b99">Log</a>(<a class="code" href="logger_8hpp.html#aca1fd1d8935433e6ba2e3918214e07f9a5f66aaa2354d753bfaad7a8887e39216">kDebug</a>, <span class="stringliteral">&quot;xHC mmio_base = %08lx\n&quot;</span>, xhc_mmio_base);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="comment">// Initialize xHC</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <a class="code" href="namespaceusb_1_1xhci.html#a73a5104eb2e91a7bef877aa7431a6235">usb::xhci::controller</a> = <span class="keyword">new</span> <a class="code" href="classusb_1_1xhci_1_1Controller.html">Controller</a>{xhc_mmio_base};</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <a class="code" href="classusb_1_1xhci_1_1Controller.html">Controller</a>&amp; xhc = *<a class="code" href="namespaceusb_1_1xhci.html#a73a5104eb2e91a7bef877aa7431a6235">usb::xhci::controller</a>;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="keywordflow">if</span> (0x8086 == <a class="code" href="namespacepci.html#a9aaf9ef581a7cca6de291efc3c2036c9">pci::ReadVendorId</a>(*xhc_dev)) {</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;      <a class="code" href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a973b0fa3a5cf128fe2be864d14167079">SwitchEhci2Xhci</a>(*xhc_dev);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    }</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> err = xhc.<a class="code" href="classusb_1_1xhci_1_1Controller.html#ad286e798319710177e793c792366f3de">Initialize</a>()) {</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      <a class="code" href="logger_8cpp.html#a7b67f04545cc3bc4793c750046527b99">Log</a>(<a class="code" href="logger_8hpp.html#aca1fd1d8935433e6ba2e3918214e07f9a5f66aaa2354d753bfaad7a8887e39216">kDebug</a>, <span class="stringliteral">&quot;xhc.Initialize failed: %s\n&quot;</span>, err.Name());</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      exit(1);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    }</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <a class="code" href="logger_8cpp.html#a7b67f04545cc3bc4793c750046527b99">Log</a>(<a class="code" href="logger_8hpp.html#aca1fd1d8935433e6ba2e3918214e07f9af5f198c05e424cf59cf410fb0de5591e">kInfo</a>, <span class="stringliteral">&quot;xHC starting\n&quot;</span>);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    xhc.<a class="code" href="classusb_1_1xhci_1_1Controller.html#af33839b864df11916aacbda68c51525d">Run</a>();</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160; </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= xhc.<a class="code" href="classusb_1_1xhci_1_1Controller.html#ad0c90fa8470109badcc3bfb23e81e168">MaxPorts</a>(); ++i) {</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      <span class="keyword">auto</span> port = xhc.<a class="code" href="classusb_1_1xhci_1_1Controller.html#aaacc1708e91093f3a0ee304181d9f287">PortAt</a>(i);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      <a class="code" href="logger_8cpp.html#a7b67f04545cc3bc4793c750046527b99">Log</a>(<a class="code" href="logger_8hpp.html#aca1fd1d8935433e6ba2e3918214e07f9a5f66aaa2354d753bfaad7a8887e39216">kDebug</a>, <span class="stringliteral">&quot;Port %d: IsConnected=%d\n&quot;</span>, i, port.IsConnected());</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160; </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      <span class="keywordflow">if</span> (port.IsConnected()) {</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">auto</span> err = <a class="code" href="namespaceusb_1_1xhci.html#ac2787bcc15dfa613708459412c73351f">ConfigurePort</a>(xhc, port)) {</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;          <a class="code" href="logger_8cpp.html#a7b67f04545cc3bc4793c750046527b99">Log</a>(<a class="code" href="logger_8hpp.html#aca1fd1d8935433e6ba2e3918214e07f9aacb2c04376333850bff6fb1065c0c171">kError</a>, <span class="stringliteral">&quot;failed to configure port: %s at %s:%d\n&quot;</span>,</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;              err.Name(), err.File(), err.Line());</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        }</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      }</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    }</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  }</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160; </div>
<div class="line"><a name="l00597"></a><span class="lineno"><a class="line" href="namespaceusb_1_1xhci.html#a62b0a181d4588f159ce8c67cc9206597">  597</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespaceusb_1_1xhci.html#a62b0a181d4588f159ce8c67cc9206597">ProcessEvents</a>() {</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="namespaceusb_1_1xhci.html#a73a5104eb2e91a7bef877aa7431a6235">controller</a>-&gt;<a class="code" href="classusb_1_1xhci_1_1Controller.html#ac9baf870543d94dd44c996c067f95337">PrimaryEventRing</a>()-&gt;<a class="code" href="classusb_1_1xhci_1_1EventRing.html#a06b3c69968a49e478cf72d2607c2d442">HasFront</a>()) {</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> err = <a class="code" href="namespaceusb_1_1xhci.html#a915e51b4a22646799d4dfce16e5d4e69">ProcessEvent</a>(*<a class="code" href="namespaceusb_1_1xhci.html#a73a5104eb2e91a7bef877aa7431a6235">controller</a>)) {</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <a class="code" href="logger_8cpp.html#a7b67f04545cc3bc4793c750046527b99">Log</a>(<a class="code" href="logger_8hpp.html#aca1fd1d8935433e6ba2e3918214e07f9aacb2c04376333850bff6fb1065c0c171">kError</a>, <span class="stringliteral">&quot;Error while ProcessEvent: %s at %s:%d\n&quot;</span>,</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            err.Name(), err.File(), err.Line());</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      }</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    }</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  }</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassError_html_a4bdebc8c23b31662aeb384a9d437717d"><div class="ttname"><a href="classError.html#a4bdebc8c23b31662aeb384a9d437717d">Error::Name</a></div><div class="ttdeci">const char * Name() const</div><div class="ttdef"><b>Definition:</b> <a href="error_8hpp_source.html#l00074">error.hpp:74</a></div></div>
<div class="ttc" id="asetupdata_8hpp_html"><div class="ttname"><a href="setupdata_8hpp.html">setupdata.hpp</a></div></div>
<div class="ttc" id="anamespacepci_html_a9aaf9ef581a7cca6de291efc3c2036c9"><div class="ttname"><a href="namespacepci.html#a9aaf9ef581a7cca6de291efc3c2036c9">pci::ReadVendorId</a></div><div class="ttdeci">uint16_t ReadVendorId(uint8_t bus, uint8_t device, uint8_t function)</div><div class="ttdoc">ベンダ ID レジスタを読み取る（全ヘッダタイプ共通）</div><div class="ttdef"><b>Definition:</b> <a href="pci_8cpp_source.html#l00203">pci.cpp:203</a></div></div>
<div class="ttc" id="astructusb_1_1xhci_1_1OperationalRegisters_html"><div class="ttname"><a href="structusb_1_1xhci_1_1OperationalRegisters.html">usb::xhci::OperationalRegisters</a></div><div class="ttdef"><b>Definition:</b> <a href="registers_8hpp_source.html#l00194">registers.hpp:194</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Controller_html_af33839b864df11916aacbda68c51525d"><div class="ttname"><a href="classusb_1_1xhci_1_1Controller.html#af33839b864df11916aacbda68c51525d">usb::xhci::Controller::Run</a></div><div class="ttdeci">Error Run()</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8cpp_source.html#l00425">xhci.cpp:425</a></div></div>
<div class="ttc" id="acontext_8hpp_html_aa739134b2dd78eb8819e8cd544af531e"><div class="ttname"><a href="context_8hpp.html#aa739134b2dd78eb8819e8cd544af531e">ep_type</a></div><div class="ttdeci">uint32_t ep_type</div><div class="ttdef"><b>Definition:</b> <a href="context_8hpp_source.html#l00048">context.hpp:48</a></div></div>
<div class="ttc" id="anamespaceusb_1_1xhci_html_a1df54355b3da2e8c724193fc3799c482"><div class="ttname"><a href="namespaceusb_1_1xhci.html#a1df54355b3da2e8c724193fc3799c482">usb::xhci::ConfigureEndpoints</a></div><div class="ttdeci">Error ConfigureEndpoints(Controller &amp;xhc, Device &amp;dev)</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8cpp_source.html#l00448">xhci.cpp:448</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1DeviceManager_html_aa7593744cc8cb5673b5cd8ca71875e91"><div class="ttname"><a href="classusb_1_1xhci_1_1DeviceManager.html#aa7593744cc8cb5673b5cd8ca71875e91">usb::xhci::DeviceManager::FindBySlot</a></div><div class="ttdeci">Device * FindBySlot(uint8_t slot_id) const</div><div class="ttdef"><b>Definition:</b> <a href="devmgr_8cpp_source.html#l00054">devmgr.cpp:54</a></div></div>
<div class="ttc" id="astructusb_1_1xhci_1_1CapabilityRegisters_html_a8be37013d553dc20e609238a73c05e44"><div class="ttname"><a href="structusb_1_1xhci_1_1CapabilityRegisters.html#a8be37013d553dc20e609238a73c05e44">usb::xhci::CapabilityRegisters::HCSPARAMS2</a></div><div class="ttdeci">MemMapRegister&lt; HCSPARAMS2_Bitmap &gt; HCSPARAMS2</div><div class="ttdef"><b>Definition:</b> <a href="registers_8hpp_source.html#l00101">registers.hpp:101</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Controller_html_a0fab568367b368dba57599a94a43d27d"><div class="ttname"><a href="classusb_1_1xhci_1_1Controller.html#a0fab568367b368dba57599a94a43d27d">usb::xhci::Controller::mmio_base_</a></div><div class="ttdeci">const uintptr_t mmio_base_</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8hpp_source.html#l00034">xhci.hpp:34</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02xhci_8cpp_03_html_a625d5cf01f252cb2975c2a55fdd5e1b8a12fcf69fd111b569f3e300dce1fbcb4c"><div class="ttname"><a href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a625d5cf01f252cb2975c2a55fdd5e1b8a12fcf69fd111b569f3e300dce1fbcb4c">anonymous_namespace{xhci.cpp}::ConfigPhase::kEnablingSlot</a></div><div class="ttdeci">@ kEnablingSlot</div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1DeviceManager_html_a6e7847818248a3464ab1d844f985aba9"><div class="ttname"><a href="classusb_1_1xhci_1_1DeviceManager.html#a6e7847818248a3464ab1d844f985aba9">usb::xhci::DeviceManager::LoadDCBAA</a></div><div class="ttdeci">Error LoadDCBAA(uint8_t slot_id)</div><div class="ttdef"><b>Definition:</b> <a href="devmgr_8cpp_source.html#l00084">devmgr.cpp:84</a></div></div>
<div class="ttc" id="astructusb_1_1xhci_1_1OperationalRegisters_html_a230b2d13015055a0aa0e427ff99bbf6d"><div class="ttname"><a href="structusb_1_1xhci_1_1OperationalRegisters.html#a230b2d13015055a0aa0e427ff99bbf6d">usb::xhci::OperationalRegisters::USBCMD</a></div><div class="ttdeci">MemMapRegister&lt; USBCMD_Bitmap &gt; USBCMD</div><div class="ttdef"><b>Definition:</b> <a href="registers_8hpp_source.html#l00195">registers.hpp:195</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1EventRing_html_a75b7ddd0e08959be4e86db7a6b75dfb7"><div class="ttname"><a href="classusb_1_1xhci_1_1EventRing.html#a75b7ddd0e08959be4e86db7a6b75dfb7">usb::xhci::EventRing::Pop</a></div><div class="ttdeci">void Pop()</div><div class="ttdef"><b>Definition:</b> <a href="ring_8cpp_source.html#l00101">ring.cpp:101</a></div></div>
<div class="ttc" id="alogger_8hpp_html_aca1fd1d8935433e6ba2e3918214e07f9af5f198c05e424cf59cf410fb0de5591e"><div class="ttname"><a href="logger_8hpp.html#aca1fd1d8935433e6ba2e3918214e07f9af5f198c05e424cf59cf410fb0de5591e">kInfo</a></div><div class="ttdeci">@ kInfo</div><div class="ttdef"><b>Definition:</b> <a href="logger_8hpp_source.html#l00006">logger.hpp:6</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02xhci_8cpp_03_html_a625d5cf01f252cb2975c2a55fdd5e1b8ad9f3f8d48edae6e6b9087fef4d15d136"><div class="ttname"><a href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a625d5cf01f252cb2975c2a55fdd5e1b8ad9f3f8d48edae6e6b9087fef4d15d136">anonymous_namespace{xhci.cpp}::ConfigPhase::kAddressingDevice</a></div><div class="ttdeci">@ kAddressingDevice</div></div>
<div class="ttc" id="anamespaceusb_1_1xhci_html_ac2787bcc15dfa613708459412c73351f"><div class="ttname"><a href="namespaceusb_1_1xhci.html#ac2787bcc15dfa613708459412c73351f">usb::xhci::ConfigurePort</a></div><div class="ttdeci">Error ConfigurePort(Controller &amp;xhc, Port &amp;port)</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8cpp_source.html#l00441">xhci.cpp:441</a></div></div>
<div class="ttc" id="asetupdata_8hpp_html_ae7f66047e6e39ba2bb6af8b95f00d1dd"><div class="ttname"><a href="setupdata_8hpp.html#ae7f66047e6e39ba2bb6af8b95f00d1dd">value</a></div><div class="ttdeci">uint16_t value</div><div class="ttdef"><b>Definition:</b> <a href="setupdata_8hpp_source.html#l00011">setupdata.hpp:11</a></div></div>
<div class="ttc" id="aclassMemMapRegister_html_a4bd4e2326664194cc74cea3996ad4a13"><div class="ttname"><a href="classMemMapRegister.html#a4bd4e2326664194cc74cea3996ad4a13">MemMapRegister::Write</a></div><div class="ttdeci">void Write(const T &amp;value)</div><div class="ttdef"><b>Definition:</b> <a href="register_8hpp_source.html#l00038">register.hpp:38</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02xhci_8cpp_03_html_acf4166de45ff46cf84d073a1720edc2b"><div class="ttname"><a href="namespaceanonymous__namespace_02xhci_8cpp_03.html#acf4166de45ff46cf84d073a1720edc2b">anonymous_namespace{xhci.cpp}::InitializeEP0Context</a></div><div class="ttdeci">void InitializeEP0Context(EndpointContext &amp;ctx, Ring *transfer_ring, unsigned int max_packet_size)</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8cpp_source.html#l00077">xhci.cpp:77</a></div></div>
<div class="ttc" id="atrb_8hpp_html_ad7f1de8f31bd7b9ca6edcecbde59a4d5"><div class="ttname"><a href="trb_8hpp.html#ad7f1de8f31bd7b9ca6edcecbde59a4d5">slot_id</a></div><div class="ttdeci">uint32_t slot_id</div><div class="ttdef"><b>Definition:</b> <a href="trb_8hpp_source.html#l00256">trb.hpp:256</a></div></div>
<div class="ttc" id="aclassError_html_ab5980e13b879db253df802b0950d1708ad7f679c6327539167ef4705938babbf6"><div class="ttname"><a href="classError.html#ab5980e13b879db253df802b0950d1708ad7f679c6327539167ef4705938babbf6">Error::kNotImplemented</a></div><div class="ttdeci">@ kNotImplemented</div><div class="ttdef"><b>Definition:</b> <a href="error_8hpp_source.html#l00020">error.hpp:20</a></div></div>
<div class="ttc" id="anamespacepci_html_a680589a5184d51cc46b643873a8fff8e"><div class="ttname"><a href="namespacepci.html#a680589a5184d51cc46b643873a8fff8e">pci::devices</a></div><div class="ttdeci">std::array&lt; Device, 32 &gt; devices</div><div class="ttdoc">ScanAllBus() により発見された PCI デバイスの一覧</div><div class="ttdef"><b>Definition:</b> <a href="pci_8hpp_source.html#l00078">pci.hpp:78</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02xhci_8cpp_03_html_a625d5cf01f252cb2975c2a55fdd5e1b8ab666c147ab3da9f993c6d438a303ca5a"><div class="ttname"><a href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a625d5cf01f252cb2975c2a55fdd5e1b8ab666c147ab3da9f993c6d438a303ca5a">anonymous_namespace{xhci.cpp}::ConfigPhase::kConfiguringEndpoints</a></div><div class="ttdeci">@ kConfiguringEndpoints</div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Port_html_a40a82c801c1ff4ece8acbcc1e99966df"><div class="ttname"><a href="classusb_1_1xhci_1_1Port.html#a40a82c801c1ff4ece8acbcc1e99966df">usb::xhci::Port::IsEnabled</a></div><div class="ttdeci">bool IsEnabled() const</div><div class="ttdef"><b>Definition:</b> <a href="port_8cpp_source.html#l00015">port.cpp:15</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Controller_html_aaacc1708e91093f3a0ee304181d9f287"><div class="ttname"><a href="classusb_1_1xhci_1_1Controller.html#aaacc1708e91093f3a0ee304181d9f287">usb::xhci::Controller::PortAt</a></div><div class="ttdeci">Port PortAt(uint8_t port_num)</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8hpp_source.html#l00025">xhci.hpp:25</a></div></div>
<div class="ttc" id="astructusb_1_1xhci_1_1DeviceContext_html_a399f9038cc97aa2d5da471d39659b7ca"><div class="ttname"><a href="structusb_1_1xhci_1_1DeviceContext.html#a399f9038cc97aa2d5da471d39659b7ca">usb::xhci::DeviceContext::slot_context</a></div><div class="ttdeci">SlotContext slot_context</div><div class="ttdef"><b>Definition:</b> <a href="context_8hpp_source.html#l00086">context.hpp:86</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02xhci_8cpp_03_html_a4133327bd6ec5fac64f5e44a96751671"><div class="ttname"><a href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a4133327bd6ec5fac64f5e44a96751671">anonymous_namespace{xhci.cpp}::RegisterCommandRing</a></div><div class="ttdeci">Error RegisterCommandRing(Ring *ring, MemMapRegister&lt; CRCR_Bitmap &gt; *crcr)</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8cpp_source.html#l00015">xhci.cpp:15</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Controller_html_a78be8fedeffd23c80bdb86c293abce69"><div class="ttname"><a href="classusb_1_1xhci_1_1Controller.html#a78be8fedeffd23c80bdb86c293abce69">usb::xhci::Controller::DeviceManager</a></div><div class="ttdeci">DeviceManager * DeviceManager()</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8hpp_source.html#l00029">xhci.hpp:29</a></div></div>
<div class="ttc" id="anamespaceusb_html_a86621f971b6f135f738ad641bcf879c0"><div class="ttname"><a href="namespaceusb.html#a86621f971b6f135f738ad641bcf879c0">usb::AllocMem</a></div><div class="ttdeci">void * AllocMem(size_t size, unsigned int alignment, unsigned int boundary)</div><div class="ttdoc">指定されたバイト数のメモリ領域を確保して先頭ポインタを返す．</div><div class="ttdef"><b>Definition:</b> <a href="memory_8cpp_source.html#l00021">memory.cpp:21</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1DeviceManager_html_a4fa25d1a6fd5c160ac9933003fed58c9"><div class="ttname"><a href="classusb_1_1xhci_1_1DeviceManager.html#a4fa25d1a6fd5c160ac9933003fed58c9">usb::xhci::DeviceManager::DeviceContexts</a></div><div class="ttdeci">DeviceContext ** DeviceContexts() const</div><div class="ttdef"><b>Definition:</b> <a href="devmgr_8cpp_source.html#l00028">devmgr.cpp:28</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Controller_html_ac9baf870543d94dd44c996c067f95337"><div class="ttname"><a href="classusb_1_1xhci_1_1Controller.html#ac9baf870543d94dd44c996c067f95337">usb::xhci::Controller::PrimaryEventRing</a></div><div class="ttdeci">EventRing * PrimaryEventRing()</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8hpp_source.html#l00023">xhci.hpp:23</a></div></div>
<div class="ttc" id="aclassMemMapRegister_html_a7d0631093e47440e0b414383dde241ea"><div class="ttname"><a href="classMemMapRegister.html#a7d0631093e47440e0b414383dde241ea">MemMapRegister::Read</a></div><div class="ttdeci">T Read() const</div><div class="ttdef"><b>Definition:</b> <a href="register_8hpp_source.html#l00030">register.hpp:30</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02xhci_8cpp_03_html_aa9c4ec63a5252e2696c922e267b068e6"><div class="ttname"><a href="namespaceanonymous__namespace_02xhci_8cpp_03.html#aa9c4ec63a5252e2696c922e267b068e6">anonymous_namespace{xhci.cpp}::addressing_port</a></div><div class="ttdeci">uint8_t addressing_port</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8cpp_source.html#l00046">xhci.cpp:46</a></div></div>
<div class="ttc" id="anamespaceusb_1_1xhci_html_a5c3fa0788ed73d1539ffd921da3bc99f"><div class="ttname"><a href="namespaceusb_1_1xhci.html#a5c3fa0788ed73d1539ffd921da3bc99f">usb::xhci::kLowSpeed</a></div><div class="ttdeci">const int kLowSpeed</div><div class="ttdef"><b>Definition:</b> <a href="speed_8hpp_source.html#l00011">speed.hpp:11</a></div></div>
<div class="ttc" id="adevice_8hpp_html"><div class="ttname"><a href="device_8hpp.html">device.hpp</a></div></div>
<div class="ttc" id="aunionusb_1_1xhci_1_1EndpointContext_html_aadcdbbcda4fef3b4402e41039d8f017b"><div class="ttname"><a href="unionusb_1_1xhci_1_1EndpointContext.html#aadcdbbcda4fef3b4402e41039d8f017b">usb::xhci::EndpointContext::ep_type</a></div><div class="ttdeci">uint32_t ep_type</div><div class="ttdef"><b>Definition:</b> <a href="context_8hpp_source.html#l00049">context.hpp:49</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02xhci_8cpp_03_html_a496b34569d293b42029c189d10f6c3fc"><div class="ttname"><a href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a496b34569d293b42029c189d10f6c3fc">anonymous_namespace{xhci.cpp}::ResetPort</a></div><div class="ttdeci">Error ResetPort(Controller &amp;xhc, Port &amp;port)</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8cpp_source.html#l00091">xhci.cpp:91</a></div></div>
<div class="ttc" id="aunionusb_1_1xhci_1_1EndpointContext_html_a16cc0f2efd47a463b4cad7bed1d15667"><div class="ttname"><a href="unionusb_1_1xhci_1_1EndpointContext.html#a16cc0f2efd47a463b4cad7bed1d15667">usb::xhci::EndpointContext::interval</a></div><div class="ttdeci">uint32_t interval</div><div class="ttdef"><b>Definition:</b> <a href="context_8hpp_source.html#l00044">context.hpp:44</a></div></div>
<div class="ttc" id="aunionusb_1_1xhci_1_1SlotContext_html"><div class="ttname"><a href="unionusb_1_1xhci_1_1SlotContext.html">usb::xhci::SlotContext</a></div><div class="ttdef"><b>Definition:</b> <a href="context_8hpp_source.html#l00009">context.hpp:9</a></div></div>
<div class="ttc" id="astructWithError_html_a3e6de5f795254e0a40ed974a636b563a"><div class="ttname"><a href="structWithError.html#a3e6de5f795254e0a40ed974a636b563a">WithError::error</a></div><div class="ttdeci">Error error</div><div class="ttdef"><b>Definition:</b> <a href="error_8hpp_source.html#l00097">error.hpp:97</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Port_html_a4564877db0b7ab0b5cf25e94ee406ae5"><div class="ttname"><a href="classusb_1_1xhci_1_1Port.html#a4564877db0b7ab0b5cf25e94ee406ae5">usb::xhci::Port::Number</a></div><div class="ttdeci">uint8_t Number() const</div><div class="ttdef"><b>Definition:</b> <a href="port_8cpp_source.html#l00007">port.cpp:7</a></div></div>
<div class="ttc" id="astructusb_1_1xhci_1_1OperationalRegisters_html_ac8d0f2fcd511074712bfd774eb6aaf13"><div class="ttname"><a href="structusb_1_1xhci_1_1OperationalRegisters.html#ac8d0f2fcd511074712bfd774eb6aaf13">usb::xhci::OperationalRegisters::CRCR</a></div><div class="ttdeci">MemMapRegister&lt; CRCR_Bitmap &gt; CRCR</div><div class="ttdef"><b>Definition:</b> <a href="registers_8hpp_source.html#l00200">registers.hpp:200</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Port_html_a827cc119289d1d9de12a1cb5e5ceb711"><div class="ttname"><a href="classusb_1_1xhci_1_1Port.html#a827cc119289d1d9de12a1cb5e5ceb711">usb::xhci::Port::IsConnected</a></div><div class="ttdeci">bool IsConnected() const</div><div class="ttdef"><b>Definition:</b> <a href="port_8cpp_source.html#l00011">port.cpp:11</a></div></div>
<div class="ttc" id="anamespacepci_html_a26c366582513de13df3b528f68f375d8"><div class="ttname"><a href="namespacepci.html#a26c366582513de13df3b528f68f375d8">pci::ReadConfReg</a></div><div class="ttdeci">uint32_t ReadConfReg(const Device &amp;dev, uint8_t reg_addr)</div><div class="ttdef"><b>Definition:</b> <a href="pci_8cpp_source.html#l00223">pci.cpp:223</a></div></div>
<div class="ttc" id="aunionusb_1_1xhci_1_1AddressDeviceCommandTRB_html"><div class="ttname"><a href="unionusb_1_1xhci_1_1AddressDeviceCommandTRB.html">usb::xhci::AddressDeviceCommandTRB</a></div><div class="ttdef"><b>Definition:</b> <a href="trb_8hpp_source.html#l00243">trb.hpp:243</a></div></div>
<div class="ttc" id="aclassInterruptVector_html_adb64aa6edf43a001911d6668066c752aafbc6ff3f8c4bc7033488f5f58a1f912a"><div class="ttname"><a href="classInterruptVector.html#adb64aa6edf43a001911d6668066c752aafbc6ff3f8c4bc7033488f5f58a1f912a">InterruptVector::kXHCI</a></div><div class="ttdeci">@ kXHCI</div><div class="ttdef"><b>Definition:</b> <a href="interrupt_8hpp_source.html#l00055">interrupt.hpp:55</a></div></div>
<div class="ttc" id="anamespacepci_html_a8664d6328011718b702012b81065983b"><div class="ttname"><a href="namespacepci.html#a8664d6328011718b702012b81065983b">pci::WriteConfReg</a></div><div class="ttdeci">void WriteConfReg(const Device &amp;dev, uint8_t reg_addr, uint32_t value)</div><div class="ttdef"><b>Definition:</b> <a href="pci_8cpp_source.html#l00227">pci.cpp:227</a></div></div>
<div class="ttc" id="astructusb_1_1xhci_1_1OperationalRegisters_html_ab5d2b3c02627dc25ffc3fed7393f3ef0"><div class="ttname"><a href="structusb_1_1xhci_1_1OperationalRegisters.html#ab5d2b3c02627dc25ffc3fed7393f3ef0">usb::xhci::OperationalRegisters::DCBAAP</a></div><div class="ttdeci">MemMapRegister&lt; DCBAAP_Bitmap &gt; DCBAAP</div><div class="ttdef"><b>Definition:</b> <a href="registers_8hpp_source.html#l00202">registers.hpp:202</a></div></div>
<div class="ttc" id="anamespaceusb_1_1xhci_html"><div class="ttname"><a href="namespaceusb_1_1xhci.html">usb::xhci</a></div><div class="ttdef"><b>Definition:</b> <a href="context_8hpp_source.html#l00005">context.hpp:5</a></div></div>
<div class="ttc" id="anamespacepci_html_a246e1675be11897121479241ac631948"><div class="ttname"><a href="namespacepci.html#a246e1675be11897121479241ac631948">pci::ReadBar</a></div><div class="ttdeci">WithError&lt; uint64_t &gt; ReadBar(Device &amp;device, unsigned int bar_index)</div><div class="ttdef"><b>Definition:</b> <a href="pci_8cpp_source.html#l00266">pci.cpp:266</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Ring_html_abee6a4476eb252eb67982fbdcac81d34"><div class="ttname"><a href="classusb_1_1xhci_1_1Ring.html#abee6a4476eb252eb67982fbdcac81d34">usb::xhci::Ring::Buffer</a></div><div class="ttdeci">TRB * Buffer() const</div><div class="ttdef"><b>Definition:</b> <a href="ring_8hpp_source.html#l00038">ring.hpp:38</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Controller_html_a984da6949804e2c6920d9c1d9d915dec"><div class="ttname"><a href="classusb_1_1xhci_1_1Controller.html#a984da6949804e2c6920d9c1d9d915dec">usb::xhci::Controller::cap_</a></div><div class="ttdeci">CapabilityRegisters *const cap_</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8hpp_source.html#l00035">xhci.hpp:35</a></div></div>
<div class="ttc" id="adescriptor_8hpp_html_acd9ed1ccc44de55e1d3eff5569663695"><div class="ttname"><a href="descriptor_8hpp.html#acd9ed1ccc44de55e1d3eff5569663695">interval</a></div><div class="ttdeci">uint8_t interval</div><div class="ttdef"><b>Definition:</b> <a href="descriptor_8hpp_source.html#l00024">descriptor.hpp:24</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02xhci_8cpp_03_html_a00375fa5c418df5ecd8f126a459f00fe"><div class="ttname"><a href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a00375fa5c418df5ecd8f126a459f00fe">anonymous_namespace{xhci.cpp}::CompleteConfiguration</a></div><div class="ttdeci">Error CompleteConfiguration(Controller &amp;xhc, uint8_t port_id, uint8_t slot_id)</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8cpp_source.html#l00183">xhci.cpp:183</a></div></div>
<div class="ttc" id="adescriptor_8hpp_html_adf8eaadf8ab47b2ff12d0dcfb448dbe8"><div class="ttname"><a href="descriptor_8hpp.html#adf8eaadf8ab47b2ff12d0dcfb448dbe8">max_packet_size</a></div><div class="ttdeci">uint8_t max_packet_size</div><div class="ttdef"><b>Definition:</b> <a href="descriptor_8hpp_source.html#l00010">descriptor.hpp:10</a></div></div>
<div class="ttc" id="astructusb_1_1xhci_1_1CapabilityRegisters_html_aa4b9e5d2280f6e7f50b415cf340c3dd5"><div class="ttname"><a href="structusb_1_1xhci_1_1CapabilityRegisters.html#aa4b9e5d2280f6e7f50b415cf340c3dd5">usb::xhci::CapabilityRegisters::HCSPARAMS1</a></div><div class="ttdeci">MemMapRegister&lt; HCSPARAMS1_Bitmap &gt; HCSPARAMS1</div><div class="ttdef"><b>Definition:</b> <a href="registers_8hpp_source.html#l00100">registers.hpp:100</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1DoorbellRegister_html"><div class="ttname"><a href="classusb_1_1xhci_1_1DoorbellRegister.html">usb::xhci::DoorbellRegister</a></div><div class="ttdef"><b>Definition:</b> <a href="registers_8hpp_source.html#l00361">registers.hpp:361</a></div></div>
<div class="ttc" id="alogger_8cpp_html_a7b67f04545cc3bc4793c750046527b99"><div class="ttname"><a href="logger_8cpp.html#a7b67f04545cc3bc4793c750046527b99">Log</a></div><div class="ttdeci">int Log(LogLevel level, const char *format,...)</div><div class="ttdef"><b>Definition:</b> <a href="logger_8cpp_source.html#l00018">logger.cpp:18</a></div></div>
<div class="ttc" id="aunionusb_1_1xhci_1_1ConfigureEndpointCommandTRB_html"><div class="ttname"><a href="unionusb_1_1xhci_1_1ConfigureEndpointCommandTRB.html">usb::xhci::ConfigureEndpointCommandTRB</a></div><div class="ttdef"><b>Definition:</b> <a href="trb_8hpp_source.html#l00275">trb.hpp:275</a></div></div>
<div class="ttc" id="astructusb_1_1xhci_1_1DeviceContext_html"><div class="ttname"><a href="structusb_1_1xhci_1_1DeviceContext.html">usb::xhci::DeviceContext</a></div><div class="ttdef"><b>Definition:</b> <a href="context_8hpp_source.html#l00085">context.hpp:85</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02xhci_8cpp_03_html_a327c7198e6f38caf6f20ebda1c9d651f"><div class="ttname"><a href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a327c7198e6f38caf6f20ebda1c9d651f">anonymous_namespace{xhci.cpp}::RequestHCOwnership</a></div><div class="ttdeci">void RequestHCOwnership(uintptr_t mmio_base, HCCPARAMS1_Bitmap hccp)</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8cpp_source.html#l00286">xhci.cpp:286</a></div></div>
<div class="ttc" id="aunionusb_1_1xhci_1_1EndpointContext_html_a86ba855dbcef90123c70191c827ab985"><div class="ttname"><a href="unionusb_1_1xhci_1_1EndpointContext.html#a86ba855dbcef90123c70191c827ab985">usb::xhci::EndpointContext::error_count</a></div><div class="ttdeci">uint32_t error_count</div><div class="ttdef"><b>Definition:</b> <a href="context_8hpp_source.html#l00048">context.hpp:48</a></div></div>
<div class="ttc" id="anamespaceusb_html_a5b351fdfba906c847bacc9c8d2a808eb"><div class="ttname"><a href="namespaceusb.html#a5b351fdfba906c847bacc9c8d2a808eb">usb::EndpointType</a></div><div class="ttdeci">EndpointType</div><div class="ttdef"><b>Definition:</b> <a href="endpoint_8hpp_source.html#l00012">endpoint.hpp:12</a></div></div>
<div class="ttc" id="aclassError_html_ab5980e13b879db253df802b0950d1708a6db265868da4306440a1f1303287b4b1"><div class="ttname"><a href="classError.html#ab5980e13b879db253df802b0950d1708a6db265868da4306440a1f1303287b4b1">Error::kInvalidPhase</a></div><div class="ttdeci">@ kInvalidPhase</div><div class="ttdef"><b>Definition:</b> <a href="error_8hpp_source.html#l00026">error.hpp:26</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1EventRing_html_ac49734ca46233e2410946aa68ac7494c"><div class="ttname"><a href="classusb_1_1xhci_1_1EventRing.html#ac49734ca46233e2410946aa68ac7494c">usb::xhci::EventRing::Front</a></div><div class="ttdeci">TRB * Front() const</div><div class="ttdef"><b>Definition:</b> <a href="ring_8hpp_source.html#l00092">ring.hpp:92</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02xhci_8cpp_03_html_a625d5cf01f252cb2975c2a55fdd5e1b8a32a54fa8629fe6e9cb3e265e959258d8"><div class="ttname"><a href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a625d5cf01f252cb2975c2a55fdd5e1b8a32a54fa8629fe6e9cb3e265e959258d8">anonymous_namespace{xhci.cpp}::ConfigPhase::kNotConnected</a></div><div class="ttdeci">@ kNotConnected</div></div>
<div class="ttc" id="anamespaceusb_1_1xhci_html_abbe999f1d0f28d7732ffab1156028e52"><div class="ttname"><a href="namespaceusb_1_1xhci.html#abbe999f1d0f28d7732ffab1156028e52">usb::xhci::kSuperSpeedPlus</a></div><div class="ttdeci">const int kSuperSpeedPlus</div><div class="ttdef"><b>Definition:</b> <a href="speed_8hpp_source.html#l00014">speed.hpp:14</a></div></div>
<div class="ttc" id="astructusb_1_1xhci_1_1InputContext_html_a1fa36c78c166a6e10213fb8c99edb2be"><div class="ttname"><a href="structusb_1_1xhci_1_1InputContext.html#a1fa36c78c166a6e10213fb8c99edb2be">usb::xhci::InputContext::input_control_context</a></div><div class="ttdeci">InputControlContext input_control_context</div><div class="ttdef"><b>Definition:</b> <a href="context_8hpp_source.html#l00101">context.hpp:101</a></div></div>
<div class="ttc" id="aunionusb_1_1xhci_1_1DCBAAP__Bitmap_html"><div class="ttname"><a href="unionusb_1_1xhci_1_1DCBAAP__Bitmap.html">usb::xhci::DCBAAP_Bitmap</a></div><div class="ttdef"><b>Definition:</b> <a href="registers_8hpp_source.html#l00168">registers.hpp:168</a></div></div>
<div class="ttc" id="astructusb_1_1xhci_1_1CapabilityRegisters_html_a54f0f025cf56f568cba9d8668e673894"><div class="ttname"><a href="structusb_1_1xhci_1_1CapabilityRegisters.html#a54f0f025cf56f568cba9d8668e673894">usb::xhci::CapabilityRegisters::HCCPARAMS1</a></div><div class="ttdeci">MemMapRegister&lt; HCCPARAMS1_Bitmap &gt; HCCPARAMS1</div><div class="ttdef"><b>Definition:</b> <a href="registers_8hpp_source.html#l00103">registers.hpp:103</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Device_html"><div class="ttname"><a href="classusb_1_1xhci_1_1Device.html">usb::xhci::Device</a></div><div class="ttdef"><b>Definition:</b> <a href="xhci_2device_8hpp_source.html#l00020">device.hpp:20</a></div></div>
<div class="ttc" id="anamespaceusb_1_1xhci_html_a73a5104eb2e91a7bef877aa7431a6235"><div class="ttname"><a href="namespaceusb_1_1xhci.html#a73a5104eb2e91a7bef877aa7431a6235">usb::xhci::controller</a></div><div class="ttdeci">Controller * controller</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8cpp_source.html#l00532">xhci.cpp:532</a></div></div>
<div class="ttc" id="aunionusb_1_1xhci_1_1SlotContext_html_af0879c8e856fd13454a726a6f8f0e744"><div class="ttname"><a href="unionusb_1_1xhci_1_1SlotContext.html#af0879c8e856fd13454a726a6f8f0e744">usb::xhci::SlotContext::route_string</a></div><div class="ttdeci">uint32_t route_string</div><div class="ttdef"><b>Definition:</b> <a href="context_8hpp_source.html#l00012">context.hpp:12</a></div></div>
<div class="ttc" id="astructpci_1_1Device_html_acd5ec13790bca0e4c115314916090a31"><div class="ttname"><a href="structpci_1_1Device.html#acd5ec13790bca0e4c115314916090a31">pci::Device::device</a></div><div class="ttdeci">uint8_t device</div><div class="ttdef"><b>Definition:</b> <a href="pci_8hpp_source.html#l00031">pci.hpp:31</a></div></div>
<div class="ttc" id="astructWithError_html"><div class="ttname"><a href="structWithError.html">WithError</a></div><div class="ttdef"><b>Definition:</b> <a href="error_8hpp_source.html#l00095">error.hpp:95</a></div></div>
<div class="ttc" id="anamespaceusb_1_1xhci_html_aa1a235251b098eebf5174d6859c086c6"><div class="ttname"><a href="namespaceusb_1_1xhci.html#aa1a235251b098eebf5174d6859c086c6">usb::xhci::kTRBTypeToName</a></div><div class="ttdeci">const std::array&lt; const char *, 64 &gt; kTRBTypeToName</div><div class="ttdef"><b>Definition:</b> <a href="trb_8cpp_source.html#l00044">trb.cpp:44</a></div></div>
<div class="ttc" id="aunionusb_1_1xhci_1_1SlotContext_html_a15b0e0fd6dd66c92efca19bd9682989d"><div class="ttname"><a href="unionusb_1_1xhci_1_1SlotContext.html#a15b0e0fd6dd66c92efca19bd9682989d">usb::xhci::SlotContext::context_entries</a></div><div class="ttdeci">uint32_t context_entries</div><div class="ttdef"><b>Definition:</b> <a href="context_8hpp_source.html#l00017">context.hpp:17</a></div></div>
<div class="ttc" id="aunionusb_1_1xhci_1_1CRCR__Bitmap_html"><div class="ttname"><a href="unionusb_1_1xhci_1_1CRCR__Bitmap.html">usb::xhci::CRCR_Bitmap</a></div><div class="ttdef"><b>Definition:</b> <a href="registers_8hpp_source.html#l00146">registers.hpp:146</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1EventRing_html_a607645ceb094980f5d3b8dfe855f028c"><div class="ttname"><a href="classusb_1_1xhci_1_1EventRing.html#a607645ceb094980f5d3b8dfe855f028c">usb::xhci::EventRing::Initialize</a></div><div class="ttdeci">Error Initialize(size_t buf_size, InterrupterRegisterSet *interrupter)</div><div class="ttdef"><b>Definition:</b> <a href="ring_8cpp_source.html#l00056">ring.cpp:56</a></div></div>
<div class="ttc" id="astructusb_1_1xhci_1_1InputControlContext_html"><div class="ttname"><a href="structusb_1_1xhci_1_1InputControlContext.html">usb::xhci::InputControlContext</a></div><div class="ttdef"><b>Definition:</b> <a href="context_8hpp_source.html#l00090">context.hpp:90</a></div></div>
<div class="ttc" id="aunionusb_1_1xhci_1_1EndpointContext_html_aab5593e170f06ca53639abcf760b4f8e"><div class="ttname"><a href="unionusb_1_1xhci_1_1EndpointContext.html#aab5593e170f06ca53639abcf760b4f8e">usb::xhci::EndpointContext::mult</a></div><div class="ttdeci">uint32_t mult</div><div class="ttdef"><b>Definition:</b> <a href="context_8hpp_source.html#l00041">context.hpp:41</a></div></div>
<div class="ttc" id="astructusb_1_1xhci_1_1OperationalRegisters_html_a0402e3b6a108d00eeeb66f7ddeb4077a"><div class="ttname"><a href="structusb_1_1xhci_1_1OperationalRegisters.html#a0402e3b6a108d00eeeb66f7ddeb4077a">usb::xhci::OperationalRegisters::USBSTS</a></div><div class="ttdeci">MemMapRegister&lt; USBSTS_Bitmap &gt; USBSTS</div><div class="ttdef"><b>Definition:</b> <a href="registers_8hpp_source.html#l00196">registers.hpp:196</a></div></div>
<div class="ttc" id="aunionusb_1_1xhci_1_1EndpointContext_html_aa76e278ee9809f6454cf3583945c0c17"><div class="ttname"><a href="unionusb_1_1xhci_1_1EndpointContext.html#aa76e278ee9809f6454cf3583945c0c17">usb::xhci::EndpointContext::SetTransferRingBuffer</a></div><div class="ttdeci">void SetTransferRingBuffer(TRB *buffer)</div><div class="ttdef"><b>Definition:</b> <a href="context_8hpp_source.html#l00067">context.hpp:67</a></div></div>
<div class="ttc" id="anamespacepci_html_a4ccca51f7e92c40fc147119885a6a816a42f75919993cdefe1b30d08ca7972e88"><div class="ttname"><a href="namespacepci.html#a4ccca51f7e92c40fc147119885a6a816a42f75919993cdefe1b30d08ca7972e88">pci::MSITriggerMode::kLevel</a></div><div class="ttdeci">@ kLevel</div></div>
<div class="ttc" id="aunionusb_1_1xhci_1_1CommandCompletionEventTRB_html_aed86ff980b2058e6aa82e28dfbf69594"><div class="ttname"><a href="unionusb_1_1xhci_1_1CommandCompletionEventTRB.html#aed86ff980b2058e6aa82e28dfbf69594">usb::xhci::CommandCompletionEventTRB::slot_id</a></div><div class="ttdeci">uint32_t slot_id</div><div class="ttdef"><b>Definition:</b> <a href="trb_8hpp_source.html#l00408">trb.hpp:408</a></div></div>
<div class="ttc" id="aunionusb_1_1xhci_1_1TransferEventTRB_html"><div class="ttname"><a href="unionusb_1_1xhci_1_1TransferEventTRB.html">usb::xhci::TransferEventTRB</a></div><div class="ttdef"><b>Definition:</b> <a href="trb_8hpp_source.html#l00358">trb.hpp:358</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02xhci_8cpp_03_html_a31f446bc33b51dfa4a2fda7caf6f410f"><div class="ttname"><a href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a31f446bc33b51dfa4a2fda7caf6f410f">anonymous_namespace{xhci.cpp}::DetermineMaxPacketSizeForControlPipe</a></div><div class="ttdeci">unsigned int DetermineMaxPacketSizeForControlPipe(unsigned int slot_speed)</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8cpp_source.html#l00055">xhci.cpp:55</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Controller_html_aaf211b4b41707edd8e79e7e367c6f0ca"><div class="ttname"><a href="classusb_1_1xhci_1_1Controller.html#aaf211b4b41707edd8e79e7e367c6f0ca">usb::xhci::Controller::CommandRing</a></div><div class="ttdeci">Ring * CommandRing()</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8hpp_source.html#l00022">xhci.hpp:22</a></div></div>
<div class="ttc" id="anamespaceusb_html_a5b351fdfba906c847bacc9c8d2a808eba2c4702e16e57dd53bc4e05df8431a171"><div class="ttname"><a href="namespaceusb.html#a5b351fdfba906c847bacc9c8d2a808eba2c4702e16e57dd53bc4e05df8431a171">usb::EndpointType::kBulk</a></div><div class="ttdeci">@ kBulk</div></div>
<div class="ttc" id="anamespacepci_html_af57068dc97191fcc3cf5b5d4b201e433"><div class="ttname"><a href="namespacepci.html#af57068dc97191fcc3cf5b5d4b201e433">pci::ConfigureMSIFixedDestination</a></div><div class="ttdeci">Error ConfigureMSIFixedDestination(const Device &amp;dev, uint8_t apic_id, MSITriggerMode trigger_mode, MSIDeliveryMode delivery_mode, uint8_t vector, unsigned int num_vector_exponent)</div><div class="ttdef"><b>Definition:</b> <a href="pci_8cpp_source.html#l00319">pci.cpp:319</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1ExtendedRegisterList_html"><div class="ttname"><a href="classusb_1_1xhci_1_1ExtendedRegisterList.html">usb::xhci::ExtendedRegisterList</a></div><div class="ttdef"><b>Definition:</b> <a href="registers_8hpp_source.html#l00385">registers.hpp:385</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Device_html_a15894875f4dfe90e65ab8b2a8f8f242b"><div class="ttname"><a href="classusb_1_1xhci_1_1Device.html#a15894875f4dfe90e65ab8b2a8f8f242b">usb::xhci::Device::AllocTransferRing</a></div><div class="ttdeci">Ring * AllocTransferRing(DeviceContextIndex index, size_t buf_size)</div><div class="ttdef"><b>Definition:</b> <a href="xhci_2device_8cpp_source.html#l00097">device.cpp:97</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Controller_html_ad286e798319710177e793c792366f3de"><div class="ttname"><a href="classusb_1_1xhci_1_1Controller.html#ad286e798319710177e793c792366f3de">usb::xhci::Controller::Initialize</a></div><div class="ttdeci">Error Initialize()</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8cpp_source.html#l00349">xhci.cpp:349</a></div></div>
<div class="ttc" id="axhci_8hpp_html"><div class="ttname"><a href="xhci_8hpp.html">xhci.hpp</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Controller_html_a64064328f197b0851feff7d436aa8aa4"><div class="ttname"><a href="classusb_1_1xhci_1_1Controller.html#a64064328f197b0851feff7d436aa8aa4">usb::xhci::Controller::Controller</a></div><div class="ttdeci">Controller(uintptr_t mmio_base)</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8cpp_source.html#l00340">xhci.cpp:340</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Port_html_a59e27e44fc516a98d611c5ceb58e923e"><div class="ttname"><a href="classusb_1_1xhci_1_1Port.html#a59e27e44fc516a98d611c5ceb58e923e">usb::xhci::Port::Reset</a></div><div class="ttdeci">Error Reset()</div><div class="ttdef"><b>Definition:</b> <a href="port_8cpp_source.html#l00031">port.cpp:31</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Controller_html_ad0c90fa8470109badcc3bfb23e81e168"><div class="ttname"><a href="classusb_1_1xhci_1_1Controller.html#ad0c90fa8470109badcc3bfb23e81e168">usb::xhci::Controller::MaxPorts</a></div><div class="ttdeci">uint8_t MaxPorts() const</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8hpp_source.html#l00028">xhci.hpp:28</a></div></div>
<div class="ttc" id="anamespaceusb_1_1xhci_html_a915e51b4a22646799d4dfce16e5d4e69"><div class="ttname"><a href="namespaceusb_1_1xhci.html#a915e51b4a22646799d4dfce16e5d4e69">usb::xhci::ProcessEvent</a></div><div class="ttdeci">Error ProcessEvent(Controller &amp;xhc)</div><div class="ttdoc">イベントリングに登録されたイベントを高々1つ処理する．</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8cpp_source.html#l00513">xhci.cpp:513</a></div></div>
<div class="ttc" id="ainterrupt_8hpp_html_a05248a33688a88a6e8f8a03c729e308e"><div class="ttname"><a href="interrupt_8hpp.html#a05248a33688a88a6e8f8a03c729e308e">type</a></div><div class="ttdeci">DescriptorType type</div><div class="ttdef"><b>Definition:</b> <a href="interrupt_8hpp_source.html#l00014">interrupt.hpp:14</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Controller_html_a7110699c627752ef993726918959a5f3"><div class="ttname"><a href="classusb_1_1xhci_1_1Controller.html#a7110699c627752ef993726918959a5f3">usb::xhci::Controller::cr_</a></div><div class="ttdeci">Ring cr_</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8hpp_source.html#l00040">xhci.hpp:40</a></div></div>
<div class="ttc" id="astructpci_1_1Device_html_af8c4acf8269a8dd4203d10d7f05218b4"><div class="ttname"><a href="structpci_1_1Device.html#af8c4acf8269a8dd4203d10d7f05218b4">pci::Device::function</a></div><div class="ttdeci">uint8_t function</div><div class="ttdef"><b>Definition:</b> <a href="pci_8hpp_source.html#l00031">pci.hpp:31</a></div></div>
<div class="ttc" id="anamespacepci_html_a2d0f757b2827f9266bebbd4db56b2bcaa826888a09763de7e2a9f60eb85d88b24"><div class="ttname"><a href="namespacepci.html#a2d0f757b2827f9266bebbd4db56b2bcaa826888a09763de7e2a9f60eb85d88b24">pci::MSIDeliveryMode::kFixed</a></div><div class="ttdeci">@ kFixed</div></div>
<div class="ttc" id="aunionusb_1_1xhci_1_1EndpointContext_html_a4db46d3a32b7479b15d30509ff36a00d"><div class="ttname"><a href="unionusb_1_1xhci_1_1EndpointContext.html#a4db46d3a32b7479b15d30509ff36a00d">usb::xhci::EndpointContext::dequeue_cycle_state</a></div><div class="ttdeci">uint32_t dequeue_cycle_state</div><div class="ttdef"><b>Definition:</b> <a href="context_8hpp_source.html#l00055">context.hpp:55</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Port_html_ae93ca133fcdeec74b8f0375bb5a6449b"><div class="ttname"><a href="classusb_1_1xhci_1_1Port.html#ae93ca133fcdeec74b8f0375bb5a6449b">usb::xhci::Port::ClearPortResetChange</a></div><div class="ttdeci">void ClearPortResetChange() const</div><div class="ttdef"><b>Definition:</b> <a href="port_8hpp_source.html#l00045">port.hpp:45</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Controller_html_a2a546530f388dd45f316e8b2a874f157"><div class="ttname"><a href="classusb_1_1xhci_1_1Controller.html#a2a546530f388dd45f316e8b2a874f157">usb::xhci::Controller::DoorbellRegisterAt</a></div><div class="ttdeci">DoorbellRegister * DoorbellRegisterAt(uint8_t index)</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8cpp_source.html#l00437">xhci.cpp:437</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Port_html"><div class="ttname"><a href="classusb_1_1xhci_1_1Port.html">usb::xhci::Port</a></div><div class="ttdef"><b>Definition:</b> <a href="port_8hpp_source.html#l00027">port.hpp:27</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1DeviceManager_html_a572c00b6a3521391740ce2ce4308beb3"><div class="ttname"><a href="classusb_1_1xhci_1_1DeviceManager.html#a572c00b6a3521391740ce2ce4308beb3">usb::xhci::DeviceManager::Initialize</a></div><div class="ttdeci">Error Initialize(size_t max_slots)</div><div class="ttdef"><b>Definition:</b> <a href="devmgr_8cpp_source.html#l00006">devmgr.cpp:6</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02xhci_8cpp_03_html_a0df55ef7f3de1fdf4d41b304e900bcef"><div class="ttname"><a href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a0df55ef7f3de1fdf4d41b304e900bcef">anonymous_namespace{xhci.cpp}::EnableSlot</a></div><div class="ttdeci">Error EnableSlot(Controller &amp;xhc, Port &amp;port)</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8cpp_source.html#l00115">xhci.cpp:115</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Device_html_a6726f0604ce19fcf4a5fb568f89f9ee5"><div class="ttname"><a href="classusb_1_1xhci_1_1Device.html#a6726f0604ce19fcf4a5fb568f89f9ee5">usb::xhci::Device::SlotID</a></div><div class="ttdeci">uint8_t SlotID() const</div><div class="ttdef"><b>Definition:</b> <a href="xhci_2device_8hpp_source.html#l00046">device.hpp:46</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02xhci_8cpp_03_html_aaf7fd6ae7c6a392b0a16a84473c10872"><div class="ttname"><a href="namespaceanonymous__namespace_02xhci_8cpp_03.html#aaf7fd6ae7c6a392b0a16a84473c10872">anonymous_namespace{xhci.cpp}::port_config_phase</a></div><div class="ttdeci">std::array&lt; volatile ConfigPhase, 256 &gt; port_config_phase</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8cpp_source.html#l00041">xhci.cpp:41</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1EventRing_html_a06b3c69968a49e478cf72d2607c2d442"><div class="ttname"><a href="classusb_1_1xhci_1_1EventRing.html#a06b3c69968a49e478cf72d2607c2d442">usb::xhci::EventRing::HasFront</a></div><div class="ttdeci">bool HasFront() const</div><div class="ttdef"><b>Definition:</b> <a href="ring_8hpp_source.html#l00088">ring.hpp:88</a></div></div>
<div class="ttc" id="alogger_8hpp_html_aca1fd1d8935433e6ba2e3918214e07f9a5f66aaa2354d753bfaad7a8887e39216"><div class="ttname"><a href="logger_8hpp.html#aca1fd1d8935433e6ba2e3918214e07f9a5f66aaa2354d753bfaad7a8887e39216">kDebug</a></div><div class="ttdeci">@ kDebug</div><div class="ttdef"><b>Definition:</b> <a href="logger_8hpp_source.html#l00007">logger.hpp:7</a></div></div>
<div class="ttc" id="anamespaceusb_html_a5b351fdfba906c847bacc9c8d2a808eba80f5016e6d907e2222f5ee8d00eea0d6"><div class="ttname"><a href="namespaceusb.html#a5b351fdfba906c847bacc9c8d2a808eba80f5016e6d907e2222f5ee8d00eea0d6">usb::EndpointType::kIsochronous</a></div><div class="ttdeci">@ kIsochronous</div></div>
<div class="ttc" id="astructpci_1_1Device_html_a903a6f7e90f79bea39114e81e3fbfec0"><div class="ttname"><a href="structpci_1_1Device.html#a903a6f7e90f79bea39114e81e3fbfec0">pci::Device::bus</a></div><div class="ttdeci">uint8_t bus</div><div class="ttdef"><b>Definition:</b> <a href="pci_8hpp_source.html#l00031">pci.hpp:31</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Device_html_aba61d71f163262a2d24e6b313f16582f"><div class="ttname"><a href="classusb_1_1xhci_1_1Device.html#aba61d71f163262a2d24e6b313f16582f">usb::xhci::Device::InputContext</a></div><div class="ttdeci">InputContext * InputContext()</div><div class="ttdef"><b>Definition:</b> <a href="xhci_2device_8hpp_source.html#l00041">device.hpp:41</a></div></div>
<div class="ttc" id="astructpci_1_1Device_html"><div class="ttname"><a href="structpci_1_1Device.html">pci::Device</a></div><div class="ttdoc">PCI デバイスを操作するための基礎データを格納する</div><div class="ttdef"><b>Definition:</b> <a href="pci_8hpp_source.html#l00030">pci.hpp:30</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02xhci_8cpp_03_html_a973b0fa3a5cf128fe2be864d14167079"><div class="ttname"><a href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a973b0fa3a5cf128fe2be864d14167079">anonymous_namespace{xhci.cpp}::SwitchEhci2Xhci</a></div><div class="ttdeci">void SwitchEhci2Xhci(const pci::Device &amp;xhc_dev)</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8cpp_source.html#l00315">xhci.cpp:315</a></div></div>
<div class="ttc" id="ainterrupt_8hpp_html"><div class="ttname"><a href="interrupt_8hpp.html">interrupt.hpp</a></div></div>
<div class="ttc" id="adescriptor_8hpp_html"><div class="ttname"><a href="descriptor_8hpp.html">descriptor.hpp</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Controller_html_ad1ce8d921969f026d9d65cfcbea02fc4"><div class="ttname"><a href="classusb_1_1xhci_1_1Controller.html#ad1ce8d921969f026d9d65cfcbea02fc4">usb::xhci::Controller::DoorbellRegisters</a></div><div class="ttdeci">DoorbellRegisterArray DoorbellRegisters() const</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8hpp_source.html#l00051">xhci.hpp:51</a></div></div>
<div class="ttc" id="aunionusb_1_1xhci_1_1DCBAAP__Bitmap_html_a2c126106ec6cee6f687ca0e509d97e1d"><div class="ttname"><a href="unionusb_1_1xhci_1_1DCBAAP__Bitmap.html#a2c126106ec6cee6f687ca0e509d97e1d">usb::xhci::DCBAAP_Bitmap::SetPointer</a></div><div class="ttdeci">void SetPointer(uint64_t value)</div><div class="ttdef"><b>Definition:</b> <a href="registers_8hpp_source.html#l00179">registers.hpp:179</a></div></div>
<div class="ttc" id="aspeed_8hpp_html"><div class="ttname"><a href="speed_8hpp.html">speed.hpp</a></div></div>
<div class="ttc" id="aunionusb_1_1xhci_1_1PortStatusChangeEventTRB_html_adbf802d97c1ea84d672f7b535a73031b"><div class="ttname"><a href="unionusb_1_1xhci_1_1PortStatusChangeEventTRB.html#adbf802d97c1ea84d672f7b535a73031b">usb::xhci::PortStatusChangeEventTRB::port_id</a></div><div class="ttdeci">uint32_t port_id</div><div class="ttdef"><b>Definition:</b> <a href="trb_8hpp_source.html#l00429">trb.hpp:429</a></div></div>
<div class="ttc" id="apci_8hpp_html"><div class="ttname"><a href="pci_8hpp.html">pci.hpp</a></div></div>
<div class="ttc" id="aunionusb_1_1xhci_1_1EndpointContext_html_a662896f1b679a377c2eb7c5ab656738f"><div class="ttname"><a href="unionusb_1_1xhci_1_1EndpointContext.html#a662896f1b679a377c2eb7c5ab656738f">usb::xhci::EndpointContext::max_primary_streams</a></div><div class="ttdeci">uint32_t max_primary_streams</div><div class="ttdef"><b>Definition:</b> <a href="context_8hpp_source.html#l00042">context.hpp:42</a></div></div>
<div class="ttc" id="aregisters_8hpp_html_a38938c329191ddb6948c0def9e183d54"><div class="ttname"><a href="registers_8hpp.html#a38938c329191ddb6948c0def9e183d54">port_speed</a></div><div class="ttdeci">uint32_t port_speed</div><div class="ttdef"><b>Definition:</b> <a href="registers_8hpp_source.html#l00215">registers.hpp:215</a></div></div>
<div class="ttc" id="aunionusb_1_1xhci_1_1SlotContext_html_a9418d01500c3f8e2edd1ddec34e824f3"><div class="ttname"><a href="unionusb_1_1xhci_1_1SlotContext.html#a9418d01500c3f8e2edd1ddec34e824f3">usb::xhci::SlotContext::root_hub_port_num</a></div><div class="ttdeci">uint32_t root_hub_port_num</div><div class="ttdef"><b>Definition:</b> <a href="context_8hpp_source.html#l00020">context.hpp:20</a></div></div>
<div class="ttc" id="aclassusb_1_1Device_html_ab262c59ce7ee3cbdb883ed694d9b7a8c"><div class="ttname"><a href="classusb_1_1Device.html#ab262c59ce7ee3cbdb883ed694d9b7a8c">usb::Device::EndpointConfigs</a></div><div class="ttdeci">EndpointConfig * EndpointConfigs()</div><div class="ttdef"><b>Definition:</b> <a href="device_8hpp_source.html#l00031">device.hpp:31</a></div></div>
<div class="ttc" id="aerror_8hpp_html_a073d632b05d5b46e6f1690a7c9e0db6a"><div class="ttname"><a href="error_8hpp.html#a073d632b05d5b46e6f1690a7c9e0db6a">MAKE_ERROR</a></div><div class="ttdeci">#define MAKE_ERROR(code)</div><div class="ttdef"><b>Definition:</b> <a href="error_8hpp_source.html#l00092">error.hpp:92</a></div></div>
<div class="ttc" id="aunionusb_1_1xhci_1_1TransferEventTRB_html_ac221bef1e210ee5620b16ccfda5c252a"><div class="ttname"><a href="unionusb_1_1xhci_1_1TransferEventTRB.html#ac221bef1e210ee5620b16ccfda5c252a">usb::xhci::TransferEventTRB::slot_id</a></div><div class="ttdeci">uint32_t slot_id</div><div class="ttdef"><b>Definition:</b> <a href="trb_8hpp_source.html#l00374">trb.hpp:374</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02xhci_8cpp_03_html_a625d5cf01f252cb2975c2a55fdd5e1b8"><div class="ttname"><a href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a625d5cf01f252cb2975c2a55fdd5e1b8">anonymous_namespace{xhci.cpp}::ConfigPhase</a></div><div class="ttdeci">ConfigPhase</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8cpp_source.html#l00025">xhci.cpp:25</a></div></div>
<div class="ttc" id="aunionusb_1_1xhci_1_1EndpointContext_html"><div class="ttname"><a href="unionusb_1_1xhci_1_1EndpointContext.html">usb::xhci::EndpointContext</a></div><div class="ttdef"><b>Definition:</b> <a href="context_8hpp_source.html#l00036">context.hpp:36</a></div></div>
<div class="ttc" id="astructusb_1_1xhci_1_1DeviceContextIndex_html"><div class="ttname"><a href="structusb_1_1xhci_1_1DeviceContextIndex.html">usb::xhci::DeviceContextIndex</a></div><div class="ttdef"><b>Definition:</b> <a href="context_8hpp_source.html#l00072">context.hpp:72</a></div></div>
<div class="ttc" id="aclassError_html_ab5980e13b879db253df802b0950d1708a31ec89da55e8cd350110774ee7004f1a"><div class="ttname"><a href="classError.html#ab5980e13b879db253df802b0950d1708a31ec89da55e8cd350110774ee7004f1a">Error::kSuccess</a></div><div class="ttdeci">@ kSuccess</div><div class="ttdef"><b>Definition:</b> <a href="error_8hpp_source.html#l00009">error.hpp:9</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02xhci_8cpp_03_html_a625d5cf01f252cb2975c2a55fdd5e1b8ac855d30d1700a38672c1e2279c15eedf"><div class="ttname"><a href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a625d5cf01f252cb2975c2a55fdd5e1b8ac855d30d1700a38672c1e2279c15eedf">anonymous_namespace{xhci.cpp}::ConfigPhase::kInitializingDevice</a></div><div class="ttdeci">@ kInitializingDevice</div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Controller_html_a1caa54bb6647aede42e82a0e6e6329b9"><div class="ttname"><a href="classusb_1_1xhci_1_1Controller.html#a1caa54bb6647aede42e82a0e6e6329b9">usb::xhci::Controller::kDeviceSize</a></div><div class="ttdeci">static const size_t kDeviceSize</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8hpp_source.html#l00032">xhci.hpp:32</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02xhci_8cpp_03_html_a625d5cf01f252cb2975c2a55fdd5e1b8a5e20f5dfc0be057afa18fdadac6d2f7a"><div class="ttname"><a href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a625d5cf01f252cb2975c2a55fdd5e1b8a5e20f5dfc0be057afa18fdadac6d2f7a">anonymous_namespace{xhci.cpp}::ConfigPhase::kResettingPort</a></div><div class="ttdeci">@ kResettingPort</div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Ring_html_a275136396db44eaf6fda0eae42faa948"><div class="ttname"><a href="classusb_1_1xhci_1_1Ring.html#a275136396db44eaf6fda0eae42faa948">usb::xhci::Ring::Push</a></div><div class="ttdeci">TRB * Push(const TRBType &amp;trb)</div><div class="ttdoc">TRB に cycle bit を設定した上でリング末尾に追加する．</div><div class="ttdef"><b>Definition:</b> <a href="ring_8hpp_source.html#l00034">ring.hpp:34</a></div></div>
<div class="ttc" id="astructusb_1_1xhci_1_1InputContext_html_aec9d7b85b5806de609d729d022fbbd73"><div class="ttname"><a href="structusb_1_1xhci_1_1InputContext.html#aec9d7b85b5806de609d729d022fbbd73">usb::xhci::InputContext::EnableSlotContext</a></div><div class="ttdeci">SlotContext * EnableSlotContext()</div><div class="ttdoc">Enable the slot context.</div><div class="ttdef"><b>Definition:</b> <a href="context_8hpp_source.html#l00109">context.hpp:109</a></div></div>
<div class="ttc" id="aclassMemMapRegister_html"><div class="ttname"><a href="classMemMapRegister.html">MemMapRegister</a></div><div class="ttdef"><b>Definition:</b> <a href="register_8hpp_source.html#l00028">register.hpp:28</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02xhci_8cpp_03_html_a625d5cf01f252cb2975c2a55fdd5e1b8a6e94fe5189de18c3b459fa3fe4329523"><div class="ttname"><a href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a625d5cf01f252cb2975c2a55fdd5e1b8a6e94fe5189de18c3b459fa3fe4329523">anonymous_namespace{xhci.cpp}::ConfigPhase::kWaitingAddressed</a></div><div class="ttdeci">@ kWaitingAddressed</div></div>
<div class="ttc" id="anamespaceusb_1_1xhci_html_a230710c277871c2a8fb820799c2e05e6"><div class="ttname"><a href="namespaceusb_1_1xhci.html#a230710c277871c2a8fb820799c2e05e6">usb::xhci::Initialize</a></div><div class="ttdeci">void Initialize()</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8cpp_source.html#l00534">xhci.cpp:534</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02xhci_8cpp_03_html_adc0354c535e5fbb98973fa3537f8de3c"><div class="ttname"><a href="namespaceanonymous__namespace_02xhci_8cpp_03.html#adc0354c535e5fbb98973fa3537f8de3c">anonymous_namespace{xhci.cpp}::OnEvent</a></div><div class="ttdeci">Error OnEvent(Controller &amp;xhc, CommandCompletionEventTRB &amp;trb)</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8cpp_source.html#l00230">xhci.cpp:230</a></div></div>
<div class="ttc" id="aclassError_html"><div class="ttname"><a href="classError.html">Error</a></div><div class="ttdef"><b>Definition:</b> <a href="error_8hpp_source.html#l00006">error.hpp:6</a></div></div>
<div class="ttc" id="aunionusb_1_1xhci_1_1CommandCompletionEventTRB_html"><div class="ttname"><a href="unionusb_1_1xhci_1_1CommandCompletionEventTRB.html">usb::xhci::CommandCompletionEventTRB</a></div><div class="ttdef"><b>Definition:</b> <a href="trb_8hpp_source.html#l00394">trb.hpp:394</a></div></div>
<div class="ttc" id="anamespaceusb_1_1xhci_html_a62b0a181d4588f159ce8c67cc9206597"><div class="ttname"><a href="namespaceusb_1_1xhci.html#a62b0a181d4588f159ce8c67cc9206597">usb::xhci::ProcessEvents</a></div><div class="ttdeci">void ProcessEvents()</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8cpp_source.html#l00597">xhci.cpp:597</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Port_html_ac8a04170075fd99ee806fc573598bb75"><div class="ttname"><a href="classusb_1_1xhci_1_1Port.html#ac8a04170075fd99ee806fc573598bb75">usb::xhci::Port::Speed</a></div><div class="ttdeci">int Speed() const</div><div class="ttdef"><b>Definition:</b> <a href="port_8cpp_source.html#l00027">port.cpp:27</a></div></div>
<div class="ttc" id="alogger_8hpp_html"><div class="ttname"><a href="logger_8hpp.html">logger.hpp</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Device_html_a8e4e103ef63a74cecf3923ea1419a4cc"><div class="ttname"><a href="classusb_1_1xhci_1_1Device.html#a8e4e103ef63a74cecf3923ea1419a4cc">usb::xhci::Device::DeviceContext</a></div><div class="ttdeci">DeviceContext * DeviceContext()</div><div class="ttdef"><b>Definition:</b> <a href="xhci_2device_8hpp_source.html#l00040">device.hpp:40</a></div></div>
<div class="ttc" id="aclassError_html_ab5980e13b879db253df802b0950d1708a8509b5d0563ed785bdebe036b13305ea"><div class="ttname"><a href="classError.html#ab5980e13b879db253df802b0950d1708a8509b5d0563ed785bdebe036b13305ea">Error::kUnknownXHCISpeedID</a></div><div class="ttdeci">@ kUnknownXHCISpeedID</div><div class="ttdef"><b>Definition:</b> <a href="error_8hpp_source.html#l00027">error.hpp:27</a></div></div>
<div class="ttc" id="astructusb_1_1xhci_1_1InputContext_html_a4eccaf8527b5176c55cb4b206722a0a2"><div class="ttname"><a href="structusb_1_1xhci_1_1InputContext.html#a4eccaf8527b5176c55cb4b206722a0a2">usb::xhci::InputContext::slot_context</a></div><div class="ttdeci">SlotContext slot_context</div><div class="ttdef"><b>Definition:</b> <a href="context_8hpp_source.html#l00102">context.hpp:102</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02xhci_8cpp_03_html_ac8a768fa737e790c084fce025ce4695f"><div class="ttname"><a href="namespaceanonymous__namespace_02xhci_8cpp_03.html#ac8a768fa737e790c084fce025ce4695f">anonymous_namespace{xhci.cpp}::MostSignificantBit</a></div><div class="ttdeci">int MostSignificantBit(uint32_t value)</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8cpp_source.html#l00066">xhci.cpp:66</a></div></div>
<div class="ttc" id="aclassusb_1_1Device_html_a39e8443ae33b9513c6e993bd29f55c3b"><div class="ttname"><a href="classusb_1_1Device.html#a39e8443ae33b9513c6e993bd29f55c3b">usb::Device::NumEndpointConfigs</a></div><div class="ttdeci">int NumEndpointConfigs()</div><div class="ttdef"><b>Definition:</b> <a href="device_8hpp_source.html#l00032">device.hpp:32</a></div></div>
<div class="ttc" id="anamespaceusb_html_a5b351fdfba906c847bacc9c8d2a808ebad206dcabae22951821cfb7585b4d2deb"><div class="ttname"><a href="namespaceusb.html#a5b351fdfba906c847bacc9c8d2a808ebad206dcabae22951821cfb7585b4d2deb">usb::EndpointType::kControl</a></div><div class="ttdeci">@ kControl</div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02xhci_8cpp_03_html_ac2690ea25de3561e14b6cd1945f92c68"><div class="ttname"><a href="namespaceanonymous__namespace_02xhci_8cpp_03.html#ac2690ea25de3561e14b6cd1945f92c68">anonymous_namespace{xhci.cpp}::AddressDevice</a></div><div class="ttdeci">Error AddressDevice(Controller &amp;xhc, uint8_t port_id, uint8_t slot_id)</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8cpp_source.html#l00134">xhci.cpp:134</a></div></div>
<div class="ttc" id="anamespaceusb_html_a5b351fdfba906c847bacc9c8d2a808eba5226558f5ccca12b5009c9e2f97d50ae"><div class="ttname"><a href="namespaceusb.html#a5b351fdfba906c847bacc9c8d2a808eba5226558f5ccca12b5009c9e2f97d50ae">usb::EndpointType::kInterrupt</a></div><div class="ttdeci">@ kInterrupt</div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02xhci_8cpp_03_html_a3886331332d12966f27e0f51f1bdea86"><div class="ttname"><a href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a3886331332d12966f27e0f51f1bdea86">anonymous_namespace{xhci.cpp}::InitializeDevice</a></div><div class="ttdeci">Error InitializeDevice(Controller &amp;xhc, uint8_t port_id, uint8_t slot_id)</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8cpp_source.html#l00169">xhci.cpp:169</a></div></div>
<div class="ttc" id="alogger_8hpp_html_aca1fd1d8935433e6ba2e3918214e07f9aacb2c04376333850bff6fb1065c0c171"><div class="ttname"><a href="logger_8hpp.html#aca1fd1d8935433e6ba2e3918214e07f9aacb2c04376333850bff6fb1065c0c171">kError</a></div><div class="ttdeci">@ kError</div><div class="ttdef"><b>Definition:</b> <a href="logger_8hpp_source.html#l00004">logger.hpp:4</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02xhci_8cpp_03_html_a625d5cf01f252cb2975c2a55fdd5e1b8a7ebe83f8599de272f076e1cbcb0cbb4d"><div class="ttname"><a href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a625d5cf01f252cb2975c2a55fdd5e1b8a7ebe83f8599de272f076e1cbcb0cbb4d">anonymous_namespace{xhci.cpp}::ConfigPhase::kConfigured</a></div><div class="ttdeci">@ kConfigured</div></div>
<div class="ttc" id="aclassError_html_ab5980e13b879db253df802b0950d1708a780fda280e50afe40d1319860b0992b3"><div class="ttname"><a href="classError.html#ab5980e13b879db253df802b0950d1708a780fda280e50afe40d1319860b0992b3">Error::kInvalidSlotID</a></div><div class="ttdeci">@ kInvalidSlotID</div><div class="ttdef"><b>Definition:</b> <a href="error_8hpp_source.html#l00015">error.hpp:15</a></div></div>
<div class="ttc" id="aunionusb_1_1xhci_1_1EnableSlotCommandTRB_html_a438ade82069187bd570750c6fe8bfe75"><div class="ttname"><a href="unionusb_1_1xhci_1_1EnableSlotCommandTRB.html#a438ade82069187bd570750c6fe8bfe75">usb::xhci::EnableSlotCommandTRB::Type</a></div><div class="ttdeci">static const unsigned int Type</div><div class="ttdef"><b>Definition:</b> <a href="trb_8hpp_source.html#l00222">trb.hpp:222</a></div></div>
<div class="ttc" id="astructWithError_html_a82883238fe2ca226301fbe88411ab67c"><div class="ttname"><a href="structWithError.html#a82883238fe2ca226301fbe88411ab67c">WithError::value</a></div><div class="ttdeci">T value</div><div class="ttdef"><b>Definition:</b> <a href="error_8hpp_source.html#l00096">error.hpp:96</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Controller_html_a3d88b629fb17a599e891db31b8bcc717"><div class="ttname"><a href="classusb_1_1xhci_1_1Controller.html#a3d88b629fb17a599e891db31b8bcc717">usb::xhci::Controller::op_</a></div><div class="ttdeci">OperationalRegisters *const op_</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8hpp_source.html#l00036">xhci.hpp:36</a></div></div>
<div class="ttc" id="astructusb_1_1xhci_1_1CapabilityRegisters_html"><div class="ttname"><a href="structusb_1_1xhci_1_1CapabilityRegisters.html">usb::xhci::CapabilityRegisters</a></div><div class="ttdef"><b>Definition:</b> <a href="registers_8hpp_source.html#l00096">registers.hpp:96</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Port_html_a5fc6023d4bab25dece783b44e98b3288"><div class="ttname"><a href="classusb_1_1xhci_1_1Port.html#a5fc6023d4bab25dece783b44e98b3288">usb::xhci::Port::IsPortResetChanged</a></div><div class="ttdeci">bool IsPortResetChanged() const</div><div class="ttdef"><b>Definition:</b> <a href="port_8cpp_source.html#l00023">port.cpp:23</a></div></div>
<div class="ttc" id="aunionusb_1_1xhci_1_1EnableSlotCommandTRB_html"><div class="ttname"><a href="unionusb_1_1xhci_1_1EnableSlotCommandTRB.html">usb::xhci::EnableSlotCommandTRB</a></div><div class="ttdef"><b>Definition:</b> <a href="trb_8hpp_source.html#l00221">trb.hpp:221</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1DeviceManager_html_a3acc6a7863322303f3c7b2ca80add419"><div class="ttname"><a href="classusb_1_1xhci_1_1DeviceManager.html#a3acc6a7863322303f3c7b2ca80add419">usb::xhci::DeviceManager::AllocDevice</a></div><div class="ttdeci">Error AllocDevice(uint8_t slot_id, DoorbellRegister *dbreg)</div><div class="ttdef"><b>Definition:</b> <a href="devmgr_8cpp_source.html#l00070">devmgr.cpp:70</a></div></div>
<div class="ttc" id="aunionusb_1_1xhci_1_1PortStatusChangeEventTRB_html"><div class="ttname"><a href="unionusb_1_1xhci_1_1PortStatusChangeEventTRB.html">usb::xhci::PortStatusChangeEventTRB</a></div><div class="ttdef"><b>Definition:</b> <a href="trb_8hpp_source.html#l00424">trb.hpp:424</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Ring_html_a5e4624913e000bc06eb11823160bab2c"><div class="ttname"><a href="classusb_1_1xhci_1_1Ring.html#a5e4624913e000bc06eb11823160bab2c">usb::xhci::Ring::Initialize</a></div><div class="ttdeci">Error Initialize(size_t buf_size)</div><div class="ttdoc">リングのメモリ領域を割り当て，メンバを初期化する．</div><div class="ttdef"><b>Definition:</b> <a href="ring_8cpp_source.html#l00012">ring.cpp:12</a></div></div>
<div class="ttc" id="aunionusb_1_1xhci_1_1TRB_html_af2ead2e68b837d442ff524d7c212294b"><div class="ttname"><a href="unionusb_1_1xhci_1_1TRB.html#af2ead2e68b837d442ff524d7c212294b">usb::xhci::TRB::trb_type</a></div><div class="ttdeci">uint32_t trb_type</div><div class="ttdef"><b>Definition:</b> <a href="trb_8hpp_source.html#l00025">trb.hpp:25</a></div></div>
<div class="ttc" id="astructusb_1_1xhci_1_1InputContext_html_afcb2ef65c889538545743ec8c3268332"><div class="ttname"><a href="structusb_1_1xhci_1_1InputContext.html#afcb2ef65c889538545743ec8c3268332">usb::xhci::InputContext::EnableEndpoint</a></div><div class="ttdeci">EndpointContext * EnableEndpoint(DeviceContextIndex dci)</div><div class="ttdoc">Enable an endpoint.</div><div class="ttdef"><b>Definition:</b> <a href="context_8hpp_source.html#l00119">context.hpp:119</a></div></div>
<div class="ttc" id="aunionusb_1_1xhci_1_1ConfigureEndpointCommandTRB_html_a01fc7150bb245096301f97f93a1eecce"><div class="ttname"><a href="unionusb_1_1xhci_1_1ConfigureEndpointCommandTRB.html#a01fc7150bb245096301f97f93a1eecce">usb::xhci::ConfigureEndpointCommandTRB::Type</a></div><div class="ttdeci">static const unsigned int Type</div><div class="ttdef"><b>Definition:</b> <a href="trb_8hpp_source.html#l00276">trb.hpp:276</a></div></div>
<div class="ttc" id="atrb_8hpp_html_a6f54b893342775cdf092c6646e57c83b"><div class="ttname"><a href="trb_8hpp.html#a6f54b893342775cdf092c6646e57c83b">port_id</a></div><div class="ttdeci">uint32_t port_id</div><div class="ttdef"><b>Definition:</b> <a href="trb_8hpp_source.html#l00428">trb.hpp:428</a></div></div>
<div class="ttc" id="anamespaceusb_1_1xhci_html_a3fed14a82ae8237cc50d33beb2193ac3"><div class="ttname"><a href="namespaceusb_1_1xhci.html#a3fed14a82ae8237cc50d33beb2193ac3">usb::xhci::kFullSpeed</a></div><div class="ttdeci">const int kFullSpeed</div><div class="ttdef"><b>Definition:</b> <a href="speed_8hpp_source.html#l00010">speed.hpp:10</a></div></div>
<div class="ttc" id="aunionusb_1_1xhci_1_1EndpointContext_html_a8488487cf5b8435fbdc20a6b9c460255"><div class="ttname"><a href="unionusb_1_1xhci_1_1EndpointContext.html#a8488487cf5b8435fbdc20a6b9c460255">usb::xhci::EndpointContext::max_packet_size</a></div><div class="ttdeci">uint32_t max_packet_size</div><div class="ttdef"><b>Definition:</b> <a href="context_8hpp_source.html#l00053">context.hpp:53</a></div></div>
<div class="ttc" id="aunionusb_1_1xhci_1_1HCCPARAMS1__Bitmap_html"><div class="ttname"><a href="unionusb_1_1xhci_1_1HCCPARAMS1__Bitmap.html">usb::xhci::HCCPARAMS1_Bitmap</a></div><div class="ttdef"><b>Definition:</b> <a href="registers_8hpp_source.html#l00043">registers.hpp:43</a></div></div>
<div class="ttc" id="aunionusb_1_1xhci_1_1SlotContext_html_ac83f0bc66a8418d8dd54a09a07ec2602"><div class="ttname"><a href="unionusb_1_1xhci_1_1SlotContext.html#ac83f0bc66a8418d8dd54a09a07ec2602">usb::xhci::SlotContext::speed</a></div><div class="ttdeci">uint32_t speed</div><div class="ttdef"><b>Definition:</b> <a href="context_8hpp_source.html#l00013">context.hpp:13</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1DoorbellRegister_html_a58e7a7b95db73d6a4b89aac02af41c59"><div class="ttname"><a href="classusb_1_1xhci_1_1DoorbellRegister.html#a58e7a7b95db73d6a4b89aac02af41c59">usb::xhci::DoorbellRegister::Ring</a></div><div class="ttdeci">void Ring(uint8_t target, uint16_t stream_id=0)</div><div class="ttdef"><b>Definition:</b> <a href="registers_8hpp_source.html#l00365">registers.hpp:365</a></div></div>
<div class="ttc" id="anamespacepci_html_a0f08f55a798464b79d71ed246e6d9f16"><div class="ttname"><a href="namespacepci.html#a0f08f55a798464b79d71ed246e6d9f16">pci::num_device</a></div><div class="ttdeci">int num_device</div><div class="ttdoc">devices の有効な要素の数</div><div class="ttdef"><b>Definition:</b> <a href="pci_8hpp_source.html#l00080">pci.hpp:80</a></div></div>
<div class="ttc" id="astructusb_1_1xhci_1_1OperationalRegisters_html_ad33f67ae240a747bd535c55c01bb56e0"><div class="ttname"><a href="structusb_1_1xhci_1_1OperationalRegisters.html#ad33f67ae240a747bd535c55c01bb56e0">usb::xhci::OperationalRegisters::CONFIG</a></div><div class="ttdeci">MemMapRegister&lt; CONFIG_Bitmap &gt; CONFIG</div><div class="ttdef"><b>Definition:</b> <a href="registers_8hpp_source.html#l00203">registers.hpp:203</a></div></div>
<div class="ttc" id="aunionusb_1_1xhci_1_1EndpointContext_html_ac10a133508079d215eae877560e962c7"><div class="ttname"><a href="unionusb_1_1xhci_1_1EndpointContext.html#ac10a133508079d215eae877560e962c7">usb::xhci::EndpointContext::max_burst_size</a></div><div class="ttdeci">uint32_t max_burst_size</div><div class="ttdef"><b>Definition:</b> <a href="context_8hpp_source.html#l00052">context.hpp:52</a></div></div>
<div class="ttc" id="aunionusb_1_1xhci_1_1AddressDeviceCommandTRB_html_a3294682dce6439c9ded7d65465c4aa36"><div class="ttname"><a href="unionusb_1_1xhci_1_1AddressDeviceCommandTRB.html#a3294682dce6439c9ded7d65465c4aa36">usb::xhci::AddressDeviceCommandTRB::Type</a></div><div class="ttdeci">static const unsigned int Type</div><div class="ttdef"><b>Definition:</b> <a href="trb_8hpp_source.html#l00244">trb.hpp:244</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02xhci_8cpp_03_html_a9c32d83b4bffdb9c24178d5033fbfb21"><div class="ttname"><a href="namespaceanonymous__namespace_02xhci_8cpp_03.html#a9c32d83b4bffdb9c24178d5033fbfb21">anonymous_namespace{xhci.cpp}::InitializeSlotContext</a></div><div class="ttdeci">void InitializeSlotContext(SlotContext &amp;ctx, Port &amp;port)</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8cpp_source.html#l00048">xhci.cpp:48</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Controller_html_aa1d1fd681a42199bca4ce5d613817b84"><div class="ttname"><a href="classusb_1_1xhci_1_1Controller.html#aa1d1fd681a42199bca4ce5d613817b84">usb::xhci::Controller::InterrupterRegisterSets</a></div><div class="ttdeci">InterrupterRegisterSetArray InterrupterRegisterSets() const</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8hpp_source.html#l00043">xhci.hpp:43</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Controller_html_a2446beb24b44446b5f6f0bc0334971bf"><div class="ttname"><a href="classusb_1_1xhci_1_1Controller.html#a2446beb24b44446b5f6f0bc0334971bf">usb::xhci::Controller::devmgr_</a></div><div class="ttdeci">class DeviceManager devmgr_</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8hpp_source.html#l00039">xhci.hpp:39</a></div></div>
<div class="ttc" id="aunionusb_1_1xhci_1_1CommandCompletionEventTRB_html_a0fa8a02da29830c069d91d5ab7a157a3"><div class="ttname"><a href="unionusb_1_1xhci_1_1CommandCompletionEventTRB.html#a0fa8a02da29830c069d91d5ab7a157a3">usb::xhci::CommandCompletionEventTRB::Pointer</a></div><div class="ttdeci">TRB * Pointer() const</div><div class="ttdef"><b>Definition:</b> <a href="trb_8hpp_source.html#l00415">trb.hpp:415</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Ring_html"><div class="ttname"><a href="classusb_1_1xhci_1_1Ring.html">usb::xhci::Ring</a></div><div class="ttdoc">Command/Transfer Ring を表すクラス．</div><div class="ttdef"><b>Definition:</b> <a href="ring_8hpp_source.html#l00019">ring.hpp:19</a></div></div>
<div class="ttc" id="asetupdata_8hpp_html_a852b86a2eaee9852ada7a43e61e311a2"><div class="ttname"><a href="setupdata_8hpp.html#a852b86a2eaee9852ada7a43e61e311a2">index</a></div><div class="ttdeci">uint16_t index</div><div class="ttdef"><b>Definition:</b> <a href="setupdata_8hpp_source.html#l00012">setupdata.hpp:12</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Controller_html"><div class="ttname"><a href="classusb_1_1xhci_1_1Controller.html">usb::xhci::Controller</a></div><div class="ttdef"><b>Definition:</b> <a href="xhci_8hpp_source.html#l00017">xhci.hpp:17</a></div></div>
<div class="ttc" id="aclassusb_1_1xhci_1_1Controller_html_a73e0b2503d19e6e554c45d3722e97571"><div class="ttname"><a href="classusb_1_1xhci_1_1Controller.html#a73e0b2503d19e6e554c45d3722e97571">usb::xhci::Controller::er_</a></div><div class="ttdeci">EventRing er_</div><div class="ttdef"><b>Definition:</b> <a href="xhci_8hpp_source.html#l00041">xhci.hpp:41</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
